{"version":3,"file":"htaccess-tester.js","mappings":"sCAAA,MAAMA,EAAS,CACbC,IAAM,IAAIC,OAAO,gHACjBC,KAAM,wBAGR,MAAMC,EACJ,GAAiB,GAEjBC,WAAAA,CAAYJ,EAAKK,GACXA,IACFL,EAAMG,EAAIG,QAAQN,EAAKK,IAAS,IAElCE,KAAKC,KAAOR,CACd,CAEA,cAAOM,CAAQN,EAAKK,GAClB,MAAMI,EAAS,IAAIN,EAAIE,GACjBK,EAAS,IAAIP,EAAIH,GAEjBW,EAAS,CAAC,WAAY,WAAY,WAAY,WAAY,OAAQ,WAAY,SAAU,QAI9F,IAAK,IAAIC,EAAE,EAAGA,EAAID,EAAOE,OAAQD,IAAK,CACpC,IAAIE,EAAQH,EAAOC,GAInB,GAFe,aAAVE,GAAyBJ,EAAOI,IAAUL,EAAOK,IAAgC,MAArBJ,EAAOI,GAAO,KAC7EJ,EAAOI,GAASL,EAAOK,GAAOC,QAAQ,UAAW,IAAML,EAAOI,IAC5DJ,EAAOI,GACT,MACEL,EAAOK,KACTJ,EAAOI,GAASL,EAAOK,GAC3B,CAEA,OAAOJ,EAAOM,UAChB,CAEAA,QAAAA,GACE,MAAQ,GAAET,KAAKU,WAAWV,KAAKL,KAAQ,KAAIK,KAAKW,SAAYX,KAAKY,SAAY,GAAEZ,KAAKW,YAAYX,KAAKY,YAAe,GAAEZ,KAAKW,YAAe,KAAKX,KAAKL,OAAS,KAAKK,KAAKa,WAAWb,KAAKc,SAASd,KAAKe,MACvM,CAEAC,MAAAA,GACE,OAAOhB,KAAKS,UACd,CAEA,QAAIR,GACF,OAAOD,KAAKS,UACd,CAEA,QAAIR,CAAKR,GACP,MAAMwB,EAAUzB,EAAOC,IAAIyB,KAAKzB,GAChC,IAAKwB,EAAS,MAAM,IAAIE,MAAM,0CAE9BnB,KAAKU,SAAeO,EAAQ,IAAM,GAClCjB,KAAKW,SAAeM,EAAQ,IAAM,GAClCjB,KAAKY,SAAeK,EAAQ,IAAM,GAClCjB,KAAKoB,SAAeH,EAAQ,IAAM,GAClCjB,KAAKqB,KAAeJ,EAAQ,IAAM,GAClCjB,KAAKa,SAAeI,EAAQ,IAAM,GAClCjB,KAAKc,OAAeG,EAAQ,IAAM,GAClCjB,KAAKe,KAAeE,EAAQ,IAAM,EACpC,CAEA,QAAItB,GACF,OAAOK,KAAKqB,KAAQ,GAAErB,KAAKoB,YAAYpB,KAAKqB,OAASrB,KAAKoB,QAC5D,CAEA,QAAIzB,CAAKA,GACP,MAAMsB,EAAUzB,EAAOG,KAAKuB,KAAKvB,GACjC,IAAKsB,EAAS,MAAM,IAAIE,MAAM,wCAE9BnB,KAAKoB,SAAeH,EAAQ,IAAM,GAClCjB,KAAKqB,KAAeJ,EAAQ,IAAM,EACpC,CAGA,UAAIK,GACF,MAAQ,GAAEtB,KAAKU,aAAaV,KAAKL,MACnC,CAEA,UAAImB,GACF,OAAOd,MAAK,EAAeS,UAC7B,CAEA,UAAIK,CAAOA,GACTd,MAAK,EAAiB,IAAIuB,EAAgBT,EAC5C,CAGA,gBAAIU,GACF,OAAOxB,MAAK,CACd,CAMAyB,KAAAA,GAAgC,IAA1BC,EAAgBC,UAAArB,OAAA,QAAAsB,IAAAD,UAAA,IAAAA,UAAA,GACpB,MAAO,CACLE,SAAU,EACV5B,KAAUD,KAAKC,KACfS,SAAUV,KAAKU,SACfC,SAAUX,KAAKW,SACfC,SAAUZ,KAAKY,SACfkB,KAAW,IAAE9B,KAAKW,SAAYX,KAAKY,SAAY,GAAEZ,KAAKW,YAAYX,KAAKY,WAAc,GAAEZ,KAAKW,WAAc,IAC1GS,SAAUpB,KAAKoB,SACfC,KAAUrB,KAAKqB,KACf1B,KAAUK,KAAKL,KACfkB,SAAUb,KAAKa,SACfC,OAAUd,KAAKc,OACfiB,KAAW,GAAE/B,KAAKa,WAAWb,KAAKc,SAClCkB,MAAWN,EAAmB1B,KAAKwB,aAAaC,QAAUzB,KAAKwB,aAAaf,UAAsC,GAClHM,KAAUf,KAAKe,KAEnB,EAGF,MAAMQ,EACJ,GAAW,CAAC,EACZ,IAAW,EAEX1B,WAAAA,CAAYiB,GAMV,GALAd,MAAK,EAAQ,CAAC,EAEVc,GAAyB,MAAdA,EAAO,KACpBA,EAASA,EAAOmB,UAAU,IAExBnB,EAAQ,CACIA,EAAOoB,MAAM,KACrBC,SAAQC,IACZ,MAAMC,EAAQD,EAAKE,QAAQ,KAE3B,GAAID,EAAQ,EAAG,CACb,MAAME,EAAMH,EAAKH,UAAU,EAAGI,GACxBG,EAAOH,EAAQ,EAAID,EAAK9B,OAAU8B,EAAKH,UAAUI,EAAQ,GAAK,GAE/DrC,MAAK,EAAMuC,KACdvC,MAAK,EAAMuC,GAAO,IAEpBvC,MAAK,EAAMuC,GAAKE,KAAKD,EACvB,IAEJ,CACF,CAEAE,GAAAA,CAAIH,GACF,QAASvC,MAAK,EAAMuC,EACtB,CAEAI,GAAAA,CAAIJ,GACF,OAAOvC,MAAK,EAAMuC,GAAOvC,MAAK,EAAMuC,GAAK,GAAK,IAChD,CAEAK,MAAAA,CAAOL,GACL,OAAOvC,MAAK,EAAMuC,GAAO,IAAIvC,MAAK,EAAMuC,IAAQ,EAClD,CAEAM,GAAAA,CAAIN,EAAKC,GACPxC,MAAK,EAAMuC,GAAO,CAACC,EACrB,CAEAM,MAAAA,CAAOP,EAAKC,GACLxC,MAAK,EAAMuC,KACdvC,MAAK,EAAMuC,GAAO,IAEpBvC,MAAK,EAAMuC,GAAKE,KAAKD,EACvB,CAEAO,OAAOR,EAAKC,GACV,GAAKxC,MAAK,EAAMuC,GAEhB,GAAIC,EAAK,CACP,MAAMH,EAAQrC,MAAK,EAAMuC,GAAKD,QAAQE,GAClCH,GAAS,IACXrC,MAAK,EAAMuC,GAAKS,OAAOX,EAAO,GAEzBrC,MAAK,EAAMuC,GAAKjC,eACZN,MAAK,EAAMuC,GAExB,aAESvC,MAAK,EAAMuC,EAEtB,CAEAU,IAAAA,GAAoB,IAAfC,IAAMvB,UAAArB,OAAA,QAAAsB,IAAAD,UAAA,KAAAA,UAAA,GACT3B,MAAK,IAAakD,CACpB,CAEAC,IAAAA,GACE,MAAMA,EAAOC,OAAOD,KAAKnD,MAAK,GAE9B,OADIA,MAAK,GAAUmD,EAAKF,OACjBE,CACT,CAEAE,MAAAA,GACE,MAAMA,EAAS,GACf,IAAK,MAAMd,KAAOvC,MAAK,EACrBqD,EAAOZ,QAAQzC,MAAK,EAAMuC,IAG5B,OADIvC,MAAK,GAAUqD,EAAOJ,OACnBI,CACT,CAEAC,OAAAA,GACE,MAAMC,EAAe,GAUrB,OATavD,KAAKmD,OACbhB,SAAQI,KACEvC,MAAK,EACd,IAAIA,MAAK,EAAMuC,IAAMU,OACrBjD,MAAK,EAAMuC,IACVJ,SAAQK,IACXe,EAAad,KAAK,CAACF,EAAKC,GAAK,GAC7B,IAEGe,CACT,CAEApB,OAAAA,CAAQqB,EAAUC,GACKzD,KAAKsD,UACbnB,SAAQuB,IAAgB,IAAdnB,EAAKC,GAAIkB,EAC9BF,EAASG,MAAMF,EAAS,CAACjB,EAAKD,EAAKvC,MAAM,GAE7C,CAEAS,QAAAA,GAAwC,IAA/BmD,EAAqBjC,UAAArB,OAAA,QAAAsB,IAAAD,UAAA,IAAAA,UAAA,GACxBb,EAAS,GAMb,OALqBd,KAAKsD,UACbnB,SAAQ0B,IAAgB,IAAdtB,EAAKC,GAAIqB,EAE9B/C,GAAW,GADEA,EAAS,IAAM8C,EAAwB,GAAK,MACnCrB,KAAOC,GAAK,IAE7B1B,CACT,CAEAE,MAAAA,GACE,OAAOhB,KAAKS,UACd,CAMAgB,KAAAA,GACE,MAAMqC,EAAY,CAAC,EACnB,IAAK,MAAMvB,KAAOvC,MAAK,EACrB8D,EAAUvB,GAAO,IAAIvC,MAAK,EAAMuC,IAElC,OAAOuB,CACT,EAGF,MAAMrC,EAAQ,SAAChC,GAAkC,IAA7BiC,EAAgBC,UAAArB,OAAA,QAAAsB,IAAAD,UAAA,IAAAA,UAAA,GAClC,OAAQ,IAAI/B,EAAIH,GAAMgC,MAAMC,EAC9B,EAEM3B,EAAUA,CAACD,EAAML,IAAQG,EAAIG,QAAQN,EAAKK,GAEhD,IACMiE,aAAkBX,SACpBW,EAAOC,QAAU,CAACpE,MAAK2B,kBAAiBE,QAAO1B,WACnD,CACA,MAAMkE,GAAI,CAEV,IACMC,kBAAkBd,SACpBc,OAAOC,MAAQ,CAACvE,MAAK2B,kBAAiBE,QAAO1B,WACjD,CACA,MAAMkE,GAAI,C,UCxQVF,EAAOC,QAJP,WACEhE,KAAKoE,aAAe,EACtB,C,UCSAL,EAAOC,QAXP,SAAqBK,EAAMC,EAAYC,EAAaC,GAClDxE,KAAKqE,KAAcA,EACnBrE,KAAKsE,WAAcA,EACnBtE,KAAKuE,YAAcA,EACnBvE,KAAKwE,MAAcA,EAAMhE,QAAQ,IAAK,IAAIA,QAAQ,IAAK,IAAI0B,MAAM,KAC9DuC,IAAIC,SAASC,UAAUC,KAAMC,OAAOF,UAAUG,MAC9CC,QAAO,SAAUC,GAChB,OAAQA,EAAK1E,OAAS,CACxB,GACJ,C,UCGAyD,EAAOC,QAZP,SAAqBK,EAAMY,EAASC,EAAcV,EAAOW,GACvDnF,KAAKqE,KAAeA,EACpBrE,KAAKiF,QAAeA,EACpBjF,KAAKkF,aAAeA,EACpBlF,KAAKwE,MAAeA,EAAMhE,QAAQ,IAAK,IAAIA,QAAQ,IAAK,IAAI0B,MAAM,KAC/DuC,IAAIC,SAASC,UAAUC,KAAMC,OAAOF,UAAUG,MAC9CC,QAAO,SAAUC,GAChB,OAAQA,EAAK1E,OAAS,CACxB,IACFN,KAAKmF,WAAeA,GAAc,EACpC,C,gBCVA,MAAMC,EAAeC,EAAQ,KACvBC,EAAcD,EAAQ,KACtBE,EAAcF,EAAQ,KAE5B,SAASG,EAAOC,GAUd,OATKC,MAAMC,QAAQF,KACjBA,EAAUA,EAAQhF,WAAWyB,MAAM,OAGrClC,KAAKyF,QAAUA,EAAQV,QAAO,SAAUa,GACtC,MAAMC,EAAUD,EAAKd,OACrB,OAAQe,EAAQvF,OAAS,GAAmC,MAA5BuF,EAAQ5D,UAAU,EAAG,EACvD,IAEOjC,KAAK8F,cACd,CAEAN,EAAOb,UAAUmB,aAAe,WAC9B,MAAMC,EAAe,IAAIX,EAEzB,IAAIY,GAAyB,EACzBb,EAAa,GACbX,EAAQ,KAEZ,IAAK,IAAInE,EAAE,EAAGA,EAAIL,KAAKyF,QAAQnF,OAAQD,IAAK,CAC1C,MAAMuF,EAAO5F,KAAKyF,QAAQpF,GAAGyE,OACvBmB,EAAQL,EAAKd,OAAO5C,MAAM,KAAK6C,QAAO,SAAUmB,GACpD,OAAOA,EAAK5F,OAAS,CACvB,IAIA,OAFkB2F,EAAM,IAGtB,IAAK,gBACHD,EAAuE,OAA7ChG,KAAKmG,YAAYF,EAAM,IAAIG,cACrD,MAEF,IAAK,cACCJ,IACFD,EAAaM,YAAcrG,KAAKmG,YAAYF,EAAM,KAEpD,MAEF,IAAK,cACCD,IACFxB,OAA6B,IAAbyB,EAAM,GAAqB,GAAKA,EAAM,GACtDd,EAAW1C,KAAK,IAAI8C,EAAYK,EAAM5F,KAAKmG,YAAYF,EAAM,IAAKjG,KAAKmG,YAAYF,EAAM,IAAKzB,KAEhG,MAEF,IAAK,cACH,GAAIwB,EAAwB,CAC1BxB,OAA6B,IAAbyB,EAAM,GAAqB,GAAKA,EAAM,GACtD,MAAMK,EAAO,IAAIhB,EAAYM,EAAM5F,KAAKmG,YAAYF,EAAM,IAAKjG,KAAKmG,YAAYF,EAAM,IAAKzB,EAAOW,GAElGY,EAAa3B,aAAa3B,KAAK6D,GAC/BnB,EAAa,EACf,EAGN,CAEA,OAAOY,CACT,EAEAP,EAAOb,UAAUwB,YAAc,SAAUI,GACvC,MAAQ,cAAcC,KAAKD,IAAM,cAAcC,KAAKD,GAChDA,EAAEE,MAAM,GAAI,GACZF,CACN,EAEAxC,EAAOC,QAAU,SAAUyB,GACzB,OAAQ,IAAID,EAAOC,EACrB,C,gBCtEA,MAAMiB,EAAKrB,EAAQ,KACbsB,EAAKtB,EAAQ,KAEb7F,EAAS,CACb,4BAA6B,sBAC7B,oBAA6B,mCAGzBoH,EAAiB,CACrB,KAAM,SACN,KAAM,UAGR,SAASrB,EAAYsB,GAcnB,GAbAzD,OAAO0D,OAAO9G,KAAM6G,GAEpB7G,KAAK+G,iBAAmB,CACtB,QAAU,EACV,4BAA6B,KAC7B,oBAAqB,MAGnB/G,KAAKuE,aAAwC,MAAxBvE,KAAKuE,YAAY,KACxCvE,KAAK+G,iBAAyB,QAAI,EAClC/G,KAAKuE,YAAcvE,KAAKuE,YAAYtC,UAAU,IAG5CjC,KAAKuE,YAAa,CACpB,MAAMtD,EAAUzB,EAAO,6BAA6B0B,KAAKlB,KAAKuE,aAE1DtD,IACFjB,KAAK+G,iBAAiB,6BAA+B9F,EAAQ,GAC7DjB,KAAKuE,YAActD,EAAQ,GAE/B,CAEA,GAAIjB,KAAKuE,cAAgBvE,KAAK+G,iBAAiB,6BAA8B,CAC3E,MAAM9F,EAAUzB,EAAO,qBAAqB0B,KAAKlB,KAAKuE,aAElDtD,IACFjB,KAAK+G,iBAAiB,qBAAuB9F,EAAQ,GACrDjB,KAAKuE,YAActD,EAAQ,GAE/B,EAEIjB,KAAKuE,aAAgBvE,KAAK+G,iBAAiB,8BAAiC/G,KAAK+G,iBAAiB,uBACpG/G,KAAKgH,GAAKhH,KAAKiH,OACX,IAAIvH,OAAOM,KAAKuE,YAAa,KAC7B,IAAI7E,OAAOM,KAAKuE,aAExB,CAEAgB,EAAYZ,UAAUuC,QAAU,SAAUzH,EAAK0H,EAAWC,EAAoBC,GAC5E,MAAMC,EAAM,CACV,KAAgBtH,KAAKqE,KACrB,cAAgB,GAKlB,GAFAiD,EAAIC,OAASvH,KAAKwH,UAEdF,EAAIC,QAAUD,EAAIC,OAAOjH,OAG3B,OAFAgH,EAAIG,UAAW,EACfH,EAAII,UAAW,EACRJ,EAGT,MAAMK,EAAqBjB,EAAGkB,iBAC5B5H,KAAKsE,YACL,SAASuD,GACPP,EAAIC,OAAO9E,KAAK,iDAAmDoF,EACrE,GACApI,EAAK0H,EAAWC,EAAoBC,GAGtC,GAAIC,EAAIC,QAAUD,EAAIC,OAAOjH,OAG3B,OAFAgH,EAAIG,UAAW,EACfH,EAAII,UAAW,EACRJ,EAST,GANAA,EAAIG,UAAW,EACfH,EAAIQ,OAAS,CACX,WAAoBH,EACpB,iBAAoBvE,OAAO0D,OAAO,CAAC,EAAG9G,KAAK+G,mBAGzC/G,KAAK+G,iBAAiB,6BAA8B,CACtD,MAAMgB,EAAUJ,EACVK,EAAUhI,KAAKuE,YAErB,OAAOvE,KAAK+G,iBAAiB,8BAC3B,IAAK,IACHO,EAAII,SAAYK,EAAUC,EAC1B,MACF,IAAK,IACHV,EAAII,SAAYK,EAAUC,EAC1B,MACF,IAAK,IACHV,EAAII,SAAYK,GAAWC,EAC3B,MACF,IAAK,KACHV,EAAII,SAAYK,GAAWC,EAC3B,MACF,IAAK,KACHV,EAAII,SAAYK,GAAWC,EAC3B,MACF,QACEV,EAAII,UAAW,EAErB,MAEK,GAAI1H,KAAK+G,iBAAiB,qBAAsB,CACnD,MAAMgB,EAAUE,SAASN,EAAoB,IACvCK,EAAUC,SAASjI,KAAKuE,YAAe,IAE7C,OAAOvE,KAAK+G,iBAAiB,sBAC3B,IAAK,MACHO,EAAII,SAAYK,GAAWC,EAC3B,MACF,IAAK,MACHV,EAAII,SAAYK,GAAWC,EAC3B,MACF,IAAK,MACHV,EAAII,SAAYK,EAAUC,EAC1B,MACF,IAAK,MACHV,EAAII,SAAYK,GAAWC,EAC3B,MACF,IAAK,MACHV,EAAII,SAAYK,EAAUC,EAC1B,MACF,IAAK,MACHV,EAAII,SAAYK,GAAWC,EAC3B,MACF,QACEV,EAAII,UAAW,EAErB,MAGEzG,QAAUjB,KAAKgH,GAAG9F,KAAKyG,GAEvBL,EAAII,WAAazG,QAEbA,UACFqG,EAAIQ,OAAO7G,QAAUA,QAAQwF,SAMjC,OAHIzG,KAAK+G,iBAAyB,SAChCO,EAAII,UAAYJ,EAAII,UAEfJ,CACT,EAEA/B,EAAYZ,UAAU6C,QAAU,WAC9B,MAAMD,EAAS,GAKf,OAHAvH,KAAKkI,kBAAkBX,GACvBvH,KAAKmI,aAAaZ,GAEXA,CACT,EAEAhC,EAAYZ,UAAUuD,kBAAoB,SAAUX,GAE1B,SAApBvH,KAAKsE,WAKToC,EAAGc,QACDxH,KAAKsE,YACL,SAASuD,GACPN,EAAO9E,KAAK,kDAAoDoF,EAClE,IARAN,EAAO9E,KAAK,yCAA2CzC,KAAKsE,WAUhE,EAEAiB,EAAYZ,UAAUwD,aAAe,SAAUZ,GAC7CZ,EAAGa,QACDxH,KAAKwE,MACLoC,GACA,SAAS5B,GACPuC,EAAO9E,KAAK,mCAAqCuC,EACnD,GAEJ,EAEAO,EAAYZ,UAAUsC,KAAO,WAC3B,OAAON,EAAGyB,QAAQpI,KAAKwE,MAAO,OACvBmC,EAAGyB,QAAQpI,KAAKwE,MAAO,SAChC,EAEAe,EAAYZ,UAAU0D,KAAO,WAC3B,OAAO1B,EAAGyB,QAAQpI,KAAKwE,MAAO,OACvBmC,EAAGyB,QAAQpI,KAAKwE,MAAO,SAChC,EAEAT,EAAOC,QAAUuB,C,gBCtMjB,MAAMA,EAAcF,EAAQ,KACtBqB,EAAcrB,EAAQ,KACtBsB,EAActB,EAAQ,KACtBiD,EAAcjD,EAAQ,KACtBkD,EAAclD,EAAQ,KAEtBuB,EAAiB,CACrB,IAAK,WACL,QACA,aACA,MAAO,gBACP,MACA,IAAK,YACL,IAAK,OACL,IAAK,OACL,IAAK,YAAa,OAAQ,eAC1B,KAAM,SACN,KAAM,cACN,MAAO,WACP,MAAO,YACP,MAAO,SACP,IAAK,cAAe,WAAY,qBAChC,IAAK,YAAa,OAAQ,eAC1B,WAAY,eAGd,SAAStB,EAAYkD,GACnBpF,OAAO0D,OAAO9G,KAAMwI,GAEpB,IAAK,IAAInI,EAAE,EAAGA,EAAIL,KAAKmF,WAAW7E,OAAQD,IACxCL,KAAKmF,WAAW9E,GAAK,IAAIkF,EAAYvF,KAAKmF,WAAW9E,IAGvDL,KAAKgH,GAAKhH,KAAKiH,OACX,IAAIvH,OAAOM,KAAKiF,QAAS,KACzB,IAAIvF,OAAOM,KAAKiF,QACtB,CAEAK,EAAYX,UAAU8D,YAAc,SAAUhJ,EAAK0H,GACjD,MAAMC,EAAqBpH,KAAKgH,GAAG9F,KAAKqH,EAAGG,qBAAoB,GAAM,IACrE,IAAIrB,EAAuB,KAC3B,MAAMsB,EAAO,GAEb,IAAK,IAAItI,EAAE,EAAGA,EAAIL,KAAKmF,WAAW7E,OAAQD,IAAK,CAC7C,MAAMiH,EAAMtH,KAAKmF,WAAW9E,GAAG6G,QAAQzH,EAAK0H,EAAWC,EAAoBC,GAE3EA,EAAuBC,EAAIQ,QAAUR,EAAIQ,OAAO7G,QAC5CqG,EAAIQ,OAAO7G,QACX,KAEJ0H,EAAKlG,KAAK6E,EACZ,CAMA,OAJAqB,EAAKlG,KACHzC,KAAKkH,QAAQzH,EAAK0H,EAAWC,EAAoBC,EAAqBrH,KAAK4I,qBAAqBD,KAG3FA,CACT,EAEArD,EAAYX,UAAUuC,QAAU,SAAUzH,EAAK0H,EAAWC,EAAoBC,EAAqBwB,GACjG,MAAMvB,EAAM,CACV,KAAgBtH,KAAKqE,KACrB,cAAgB,GAKlB,GAFAiD,EAAIC,OAASvH,KAAKwH,UAEdF,EAAIC,QAAUD,EAAIC,OAAOjH,OAG3B,OAFAgH,EAAIG,UAAW,EACfH,EAAII,UAAW,EACRJ,EAGT,IAAIwB,EACJ,GAA0B,MAAtB9I,KAAKkF,aACP4D,EAAUrJ,MAEP,CACH,MAAMsJ,EAA6BrC,EAAGkB,iBACpC5H,KAAKkF,cACL,SAAS2C,EAAUmB,IACI,iBAAhBA,GAAoC5B,IAEzCE,EAAIC,OAAO9E,KAAK,mDAAqDoF,EACvE,GACApI,EAAK0H,EAAWC,EAAoBC,EACpCrH,KAAKiJ,4BAGPH,EAAUP,EAAGW,mBACXzJ,EAAKsJ,EACL/I,KAAKmJ,QAASnJ,KAAKoJ,QAASpJ,KAAKqJ,QAErC,CAEA,GAAI/B,EAAIC,QAAUD,EAAIC,OAAOjH,OAG3B,OAFAgH,EAAIG,UAAW,EACfH,EAAII,UAAW,EACRJ,EAGTA,EAAIG,UAAW,EACfH,EAAII,WAAaN,EACjBE,EAAIgC,qBAAuBT,EAC3BvB,EAAIQ,OAAS,CACX,IAAegB,EACf,YAAgB9I,KAAKuJ,iBAAmBvJ,KAAKwJ,yBAA2B,KACxE,UAAexJ,KAAKyJ,cACpB,WAAezJ,KAAK0J,gBAGlBtC,IACFE,EAAIQ,OAAO7G,QAAUmG,EAAmBX,SAE1Ca,EAAIqC,YACCrC,EAAIQ,OAAO8B,aACXtC,EAAIQ,OAAO8B,aAAe,KAC1BtC,EAAIQ,OAAO8B,YAAe,KAG1BtC,EAAIqC,aAAepB,EAAGsB,gBAAgBf,KACzCxB,EAAIqC,aAAqB,EACzBrC,EAAIQ,OAAO8B,YAAc,KAG3BtC,EAAIwC,eAAiB9J,KAAK+J,gBAC1BzC,EAAI0C,QAAiBhK,KAAKiK,SAE1B,IAAIC,EAAc5C,EAAIG,UAAaH,EAAII,UAAmC,MAAtB1H,KAAKkF,aAErDlF,KAAKmK,eADL,EAGJ,KAAQD,EAAY,GAAMlK,KAAKoK,QAAQ9C,EAAKH,EAAWE,IACrD6C,IAGF,OAAO5C,CACT,EAEAhC,EAAYX,UAAUyF,QAAU,SAAU9C,EAAKH,EAAWE,GACxD,MAAMD,EAAqBpH,KAAKgH,GAAG9F,KAAKqH,EAAG8B,gBAAgB/C,EAAIQ,OAAOrI,MACtE,IAAK2H,EAAoB,OAAO,EAEhC,MAAM3H,EAAM8I,EAAG+B,iBAAiBhD,EAAIQ,OAAOrI,KAC3C,IAAI8K,GAAK,EAET,MAAMxB,EAA6BrC,EAAGkB,iBACpC5H,KAAKkF,cACL,SAAS2C,GACP0C,GAAK,CACP,GACA9K,EAAK0H,EAAWC,EAAoBC,EACpCrH,KAAKiJ,4BAGDH,EAAUP,EAAGW,mBACjBzJ,EAAKsJ,EACL/I,KAAKmJ,QAASnJ,KAAKoJ,QAASpJ,KAAKqJ,SAkBnC,OAfIkB,IACGjD,EAAIQ,OAAa,OACpBR,EAAIQ,OAAa,KAAI,CAAC,MAAS,EAAG,WAAc,KAElDR,EAAIQ,OAAa,KAAE0C,QACnBlD,EAAIQ,OAAa,KAAE2C,WAAWhI,KAAK,CACjC,IAAahD,EACb,UAAa6I,EAAGoC,sBAAsBpD,EAAIQ,OAAOrI,KACjD,QAAa6H,EAAIQ,OAAO7G,UAG1BqG,EAAIQ,OAAOrI,IAAUqJ,EACrBxB,EAAIQ,OAAO7G,QAAUmG,EAAmBX,SAGnC8D,CACT,EAEAjF,EAAYX,UAAU6C,QAAU,WAC9B,MAAMD,EAAS,GAKf,OAHAvH,KAAK2K,0BAA0BpD,GAC/BvH,KAAKmI,aAAaZ,GAEXA,CACT,EAEAjC,EAAYX,UAAUgG,0BAA4B,SAAUpD,GAC1Db,EAAGc,QACDxH,KAAKkF,cACL,SAAS2C,GACPN,EAAO9E,KAAK,oDAAsDoF,EACpE,GAEJ,EAEAvC,EAAYX,UAAUwD,aAAe,SAAUZ,GAC7CZ,EAAGa,QACDxH,KAAKwE,MACLoC,GACA,SAAS5B,GACPuC,EAAO9E,KAAK,mCAAqCuC,EACnD,GAEJ,EAEAM,EAAYX,UAAUiE,qBAAuB,SAAUD,GACrD,MAAMiC,EAAQ,CACZC,aAAgB,EAChBC,WAAgB,EAChBC,gBAAgB,GAGlB,IAAK,IAAI1K,EAAE,EAAGA,EAAIL,KAAKmF,WAAW7E,OAAQD,IAIxC,GAHAuK,EAAMC,YAAc7K,KAAKmF,WAAW9E,GAAGgI,OAGnCuC,EAAME,WAAaF,EAAMG,eAC3BH,EAAME,UAAiBF,EAAMC,YAC7BD,EAAMG,eAAiBH,EAAMC,gBAF/B,CAOA,IAAKlC,EAAKtI,GAAGqH,SAAU,CACrB,GAAIkD,EAAMC,YACR,SAGA,OAAO,CAEX,CACSD,EAAMC,cACbD,EAAMG,gBAAiB,EACvBH,EAAME,UAAiBF,EAAMC,YAb/B,CAiBF,OAAO,CACT,EAEAvF,EAAYX,UAAU4E,cAAgB,WACpC,OAC6C,IAArCvJ,KAAKwE,MAAMlC,QAAQ,OACkB,IAArCtC,KAAKwE,MAAMlC,QAAQ,aAElB,KAG+B,IAAhCtC,KAAKwE,MAAMlC,QAAQ,OACa,IAAhCtC,KAAKwE,MAAMlC,QAAQ,QAElB,IAEF,CACT,EAEAgD,EAAYX,UAAU6E,sBAAwB,WAC5C,OAAO7C,EAAGqE,oBAAoBhL,KAAKwE,MAAO,IAAY,MAC/CmC,EAAGqE,oBAAoBhL,KAAKwE,MAAO,WAAY,IACxD,EAEAc,EAAYX,UAAU+E,aAAe,WACnC,OAAO/C,EAAGqE,oBAAoBhL,KAAKwE,MAAO,IAAQ,IAC3CmC,EAAGqE,oBAAoBhL,KAAKwE,MAAO,OAAQ,EACpD,EAEAc,EAAYX,UAAUwF,aAAe,WACnC,OAAOxD,EAAGqE,oBAAoBhL,KAAKwE,MAAO,IAAQ,MAC3CmC,EAAGqE,oBAAoBhL,KAAKwE,MAAO,OAAQ,IACpD,EAEAc,EAAYX,UAAU8E,YAAc,WAClC,OAAO9C,EAAGsE,mBAAmBjL,KAAKwE,MAAO,MAClCmC,EAAGsE,mBAAmBjL,KAAKwE,MAAO,OAC3C,EAEAc,EAAYX,UAAUuG,KAAO,WAC3B,OAAOvE,EAAGsE,mBAAmBjL,KAAKwE,MAAO,MAClCmC,EAAGyB,QAAQpI,KAAKwE,MAAO,IAChC,EAEAc,EAAYX,UAAUwG,OAAS,WAC7B,OAAOxE,EAAGsE,mBAAmBjL,KAAKwE,MAAO,MAC3C,EAEAc,EAAYX,UAAUyG,QAAU,WAC9B,OAAOzE,EAAGyB,QAAQpI,KAAKwE,MAAO,QAChC,EAEAc,EAAYX,UAAU0G,MAAQ,WAC5B,OAAO1E,EAAGyB,QAAQpI,KAAKwE,MAAO,QACvBmC,EAAGyB,QAAQpI,KAAKwE,MAAO,gBAChC,EAEAc,EAAYX,UAAUsC,KAAO,WAC3B,OAAON,EAAGyB,QAAQpI,KAAKwE,MAAO,OACvBmC,EAAGyB,QAAQpI,KAAKwE,MAAO,SAChC,EAEAc,EAAYX,UAAU0E,MAAQ,WAC5B,OAAO1C,EAAGyB,QAAQpI,KAAKwE,MAAO,QACvBmC,EAAGyB,QAAQpI,KAAKwE,MAAO,WAChC,EAEAc,EAAYX,UAAUyE,MAAQ,WAC5B,OAAOzC,EAAGyB,QAAQpI,KAAKwE,MAAO,QACvBmC,EAAGyB,QAAQpI,KAAKwE,MAAO,YAChC,EAEAc,EAAYX,UAAUwE,MAAQ,WAC5B,OAAOxC,EAAGyB,QAAQpI,KAAKwE,MAAO,QACvBmC,EAAGyB,QAAQpI,KAAKwE,MAAO,SAChC,EAEAc,EAAYX,UAAUoF,cAAgB,WACpC,OAAOpD,EAAGyB,QAAQpI,KAAKwE,MAAO,OACvBmC,EAAGyB,QAAQpI,KAAKwE,MAAO,cAChC,EAEAc,EAAYX,UAAUsF,OAAS,WAC7B,OAAOtD,EAAGyB,QAAQpI,KAAKwE,MAAO,MACvBmC,EAAGyB,QAAQpI,KAAKwE,MAAO,SACvBmC,EAAGyB,QAAQpI,KAAKwE,MAAO,MAChC,EAEAc,EAAYX,UAAUsE,yBAA2B,WAC/C,MAAO,CACL,EAASjJ,KAAKkL,OACd,IAASlL,KAAKmL,SACd,MAASnL,KAAKoL,UACd,IAASpL,KAAKqL,QAElB,EAEAtH,EAAOC,QAAUsB,C,gBCnVjB,MAAMA,EAAiBD,EAAQ,KACzBiD,EAAiBjD,EAAQ,KACzBkD,EAAiBlD,EAAQ,KACzBiG,EAAiBjG,EAAQ,KAE/B,SAASkG,EAAeC,GAGtB,OAFAxL,KAAKwL,UAAYA,EAEVxL,KAAKkH,SACd,CAEAqE,EAAe5G,UAAUuC,QAAU,WACjClH,KAAKyL,aAAe,CAAC,EAErB,IACEzL,KAAK8F,eAELwC,EAAGoD,eACD1L,KAAK+F,aAAaM,aAGpBrG,KAAK2L,MAAQ,GACb,IAAK,IAAItL,EAAE,EAAGA,EAAIL,KAAK+F,aAAa3B,aAAa9D,OAAQD,IAAK,CAC5D,MAAMiG,EAAO,IAAIhB,EACftF,KAAK+F,aAAa3B,aAAa/D,IAGlCL,KAAK2L,MAAMlJ,KAAK6D,EACjB,CAEA,MAAM,OAACwB,EAAM,IAAER,GAAOtH,KAAK4L,gBACzB5L,KAAKwL,UAAU/L,IACfO,KAAKwL,UAAUrE,WAGjBnH,KAAKyL,aAAaI,SAAU,EAC5B7L,KAAKyL,aAAa3D,OAAUA,EAC5B9H,KAAKyL,aAAanE,IAAUA,CAC9B,CACA,MAAMrD,GACJjE,KAAKyL,aAAaI,SAAU,EAC5B7L,KAAKyL,aAAaK,MAAU7H,EAAE8H,OAChC,CAEA,OAAO/L,KAAKyL,YACd,EAEAF,EAAe5G,UAAUmB,aAAe,WACtC,IAAIkG,EAAkBhM,KAAKwL,UAAUS,SAErCjM,KAAK+F,aAAeuF,EAAeU,EACrC,EAEAT,EAAe5G,UAAUiH,gBAAkB,SAAUnM,EAAK0H,GACxDoB,EAAG2D,UAAUzM,GAEb,MAAM0M,EAAY,GAClB,IAAIC,EAAc,KACdC,EAAc,EAElB,IAAK,IAAIhM,EAAE,EAAGA,EAAIL,KAAK2L,MAAMrL,OAAQD,IAAK,CACxC,MACMiM,EADWtM,KAAK2L,MAAMtL,GACNoI,YAAYhJ,EAAK0H,GAEvC,IAAKmF,IAAaA,EAAShM,OAAQ,SACnC6L,EAAQ1J,KAAK6J,GAEb,MAAMhF,EAAMgF,EAASA,EAAShM,OAAS,GAEvC,GAAI+L,EAAa,EACf/E,EAAIiF,YAAa,EACjBF,SAIF,GAAK/E,EAAIG,UAAaH,EAAII,SAA1B,CAQA,GANIJ,EAAIQ,SACNsE,EAAc9E,EAAIQ,QAEhBR,EAAIQ,QAAUR,EAAIQ,OAAOuE,aAC3BA,GAAc/E,EAAIQ,OAAOuE,YAEvB/E,EAAIQ,QAAUR,EAAIQ,OAAOrI,MAC3B6H,EAAIQ,OAAO0E,UAAYlE,EAAGoC,sBAAsBpD,EAAIQ,OAAOrI,KAC3D6H,EAAIQ,OAAOrI,IAAY8I,EAAG+B,iBAAiBhD,EAAIQ,OAAOrI,KACtDA,EAAM6H,EAAIQ,OAAOrI,IAEb6H,EAAIwC,gBAAgB,CACtB,MAAM2C,EAAOzM,KAAK4L,gBAAgBnM,EAAK0H,GAEvCG,EAAiB,YAAImF,EAAKnF,IAC1B8E,EAAcK,EAAK3E,QAAUsE,EAC7B,KACF,CAGF,GAAI9E,EAAIQ,QAAUR,EAAIQ,OAAO8B,cAAgBtC,EAAIqC,YAAa,MAE9D,GAAIrC,EAAI0C,QAAS,KAxB2B,CAyB9C,CAEA,MAAO,CACL,OAAUoC,EACV,IAAU1G,MAAMf,UAAU+H,OAAO/I,MAAM,GAAIwI,GAE/C,EAEApI,EAAOC,QAAU,SAAUwH,GACzB,OAAQ,IAAID,EAAeC,EAC7B,C,UC9GA,IAAInF,EAAc,IAiBlBtC,EAAOC,QAAU,CACf0H,eAhBqB,SAASiB,GAC9BtG,EAAcsG,GAAM,GACtB,EAeEjC,sBAb4B,SAASkC,GAGrC,OAFKA,IACHA,EAAgB,IACiC,SAA/CA,EAAc3K,UAAU,EAAE,GAAGmE,cACxB,KAEDC,GAAuD,IAAvCuG,EAActK,QAAQ+D,IACzCA,EAAc,IAAMuG,GAAepM,QAAQ,YAAa,KACzDoM,CACN,E,UCfA,MAsCM3B,EAAqB,SAASzG,EAAOQ,GACzC,IAAK,IAAI3E,EAAE,EAAGA,EAAImE,EAAMlE,OAAQD,IAC9B,GAAqC,IAAjCmE,EAAMnE,GAAGiC,QAAQ0C,EAAO,KAC1B,OAAOR,EAAMnE,GAAG4B,UAAW+C,EAAK1E,OAAS,GAI7C,MAAO,EACT,EAEM8H,EAAU,SAAS5D,EAAOQ,GAC9B,OAAiC,IAAzBR,EAAMlC,QAAQ0C,EACxB,EAEAjB,EAAOC,QAAU,CACfwD,QArDc,SAAUhD,EAAOoC,EAAgBiG,GAC/C,GAAKnH,MAAMC,QAAQiB,IAAoBA,EAAetG,QAAoC,mBAAlBuM,EAExE,IAAK,IAAIxM,EAAE,EAAGA,EAAImE,EAAMlE,OAAQD,IAAK,CACnC,MAAM2E,EAAOR,EAAMnE,GACnB,IAAIyM,GAAc,EAElB,IAAK,IAAIC,EAAE,EAAGA,EAAInG,EAAetG,OAAQyM,IAAK,CAC5C,MAAMC,EAAgBpG,EAAemG,GAErC,GAAIC,aAAyBtN,QAC3B,GAAIsN,EAAc9L,KAAK8D,GAAO,CAC5B8H,GAAc,EACd,KACF,OAEG,GAAIE,IAAkBhI,EAAM,CAC/B8H,GAAc,EACd,KACF,CACF,CAEKA,GACHD,EAAc7H,EAElB,CACF,EA4BEgG,oBA1B0B,SAASxG,EAAOQ,EAAMiI,GAChD,IAAIC,EAAQjC,EAAmBzG,EAAOQ,GAEtC,OAAOkI,EACHjF,SAASiF,EAAO,IACfD,GAAgB7E,EAAQ5D,EAAOQ,GAC5BiI,EACA,CACV,EAmBEhC,qBACA7C,U,gBCxDF,MAAM+E,EAAc9H,EAAAA,KAAAA,MACd+H,EAAc/H,EAAAA,KAAAA,QAuBdgI,EAAoB,SAAS5N,EAAK6N,GACtC,MAAMjL,EAAQiL,EACV7N,EAAI8N,YAAY,KAChB9N,EAAI6C,QAAQ,KAMhB,OAJgBD,GAAS,GAAOA,EAAS5C,EAAIa,OAAS,EAClDb,EAAIwC,UAAUI,EAAQ,GACtB,EAGN,EAIA,IAAImL,EAAc,KAElB,MA2BMnD,EAAkB,SAASxJ,GAC/B,OAAQA,GAA6B,MAAhBA,EAAS,GAC1BA,EAASoB,UAAU,GACnBpB,CACN,EAoDM4M,EAAuB,SAASC,EAAeC,EAAWC,EAAWC,GACzE,MAAMC,EAAW,IAAIpO,OAAQ,IAAGiO,KAAc,KACxCI,EAAW,IAAIrO,OAAQ,IAAGkO,MAEhC,OAAOF,EAAclN,QAAQsN,GAAU,SAASE,GAC9C,OAAID,EAASvH,KAAKwH,GACTA,EAEE,MAANA,GAAeH,EAGZ,IAAGG,EAAEC,WAAW,GAAGxN,SAAS,IAAIyN,gBAF/B,GAGX,GACF,EAIAnK,EAAOC,QAAU,CACfkF,mBAxIyB,SAASiF,EAASrF,EAASwE,EAAKc,EAAKC,GAC9D,MAAMC,EAAYjB,EAAkBc,EAASb,GACvCiB,EAAYlB,EAAkBvE,EAASwE,GAE7C,OAAKgB,EAGAC,EAMIF,EACFvF,EAAU,IAAMwF,EACjBxF,EAPGsF,EACHtF,EACCA,EAAU,IAAMwF,EALdxF,CAYX,EAwHEuE,oBACAnB,UAvGgB,SAASzM,GACzB,GAAIA,KAAS+N,GAAeA,EAAWvN,OAASR,GAAO,CACrD,MAAMwG,EAAQkH,EAAU1N,GACxB,IAAKwG,IAAUA,EAAMvF,WAAauF,EAAM7E,SAAU,OAElDoM,EAAavH,CACf,CACF,EAiGEuI,eA/FqB,WACrB,OAAOhB,CACT,EA8FE9E,oBA5F0B,SAAS+F,EAAwBC,GAC3D,IAAKlB,IAAeA,EAAW3M,SAAU,MAAO,GAEhD,IAAIA,EAAW2M,EAAW3M,SAQ1B,OANI4N,IACF5N,EAAWwJ,EAAgBxJ,IAEzB6N,IACF7N,EAAW8N,UAAU9N,IAEhBA,CACT,EAiFEwJ,kBACAC,iBA1EuB,SAASsC,GAMhC,OALKA,IACHA,EAAgB,IACkC,SAA/CA,EAAc3K,UAAU,EAAE,GAAGmE,eAA+BwG,GAAuC,MAArBA,EAAc,KAC/FA,EAAgB,IAAMA,GAEjBY,EACHJ,EAAYI,EAAWvN,KAAM2M,GAC7BgC,EACN,EAkEE/E,gBAhEsB,SAASf,GAC/B,IAAK0E,EAAY,OAAO,EAExB,MAAMvH,EAAQkH,EAAUrE,GACxB,SAAK7C,GAAUA,EAAMvF,UAAauF,EAAM7E,YAEhC6E,EAAMvF,WAAa8M,EAAW9M,UAAcuF,EAAMtG,OAAS6N,EAAW7N,KAChF,EA0DEkP,qBAtD2B,SAASnB,EAAelJ,GACnD,IAAKkJ,IAAkBlJ,EACrB,OAAOkJ,EAET,IAAKlJ,EAAMsK,IAAMtK,EAAMuK,MACrB,OAAOrB,EAET,IAAIC,EAAY,GACZC,EAAYpJ,EAAMwK,KAAO,GAiB7B,OAZIrB,EAHAnJ,EAAMsK,EACe,iBAAZtK,EAAMsK,EAEHtK,EAAMsK,EAGN,aAMF,mBAGPrB,EAAqBC,EAAeC,EAAWC,EAAWpJ,EAAMqJ,IACzE,E,gBCzHA,MAAMV,EAAY9H,EAAAA,KAAAA,MACZkD,EAAYlD,EAAQ,KAEpB7F,EAAS,CACb,wBAA6B,aAC7B,wBAA6B,YAE7B,kBAA6B,olBAC7B,uBAA6B,kBAC7B,2BAA6B,gzCAC7B,uBAA6B,mBAE7B,mBAA6B,aAGzByP,EAAY,SAAS1M,GACzB,MAAM2M,EAAQ1P,EAAO+C,GAKrB,OAHI2M,EAAMC,SACRD,EAAME,UAAY,GAEbF,CACT,EAiGMG,EAAyB,SAAS5P,EAAK0H,GAC3C,IAAK1H,EAAK,OAEL0H,EAAkB,SACrBA,EAAkB,OAAI,CAAC,GAEpBA,EAAU,qBACbA,EAAU,mBAAqB,CAAC,GAElC,MAAMlB,EAAQkH,EAAU1N,GAExB0H,EAAkB,OAAe,YAAKlB,EAAMpF,SAC5CsG,EAAkB,OAAgB,aAAIlB,EAAMjE,MAC5CmF,EAAkB,OAAe,YAAK1H,EAEtC0H,EAAU,mBAAgC,YAAKlB,EAAMpF,SACrDsG,EAAU,mBAAiC,aAAIlB,EAAMjE,MACrDmF,EAAU,mBAAgC,YAAK1H,CACjD,EAEAsE,EAAOC,QAAU,CACfwD,QA3Gc,SAAUlD,EAAYuI,GACpC,IAAKvI,GAAwC,mBAAlBuI,EAA+B,OAE1D,MAAMyC,EAAgB,GACtB,IAAIJ,EAAOjO,EAGX,IADAiO,EAAQD,EAAU,oBACXhO,EAAUiO,EAAMhO,KAAKoD,IAC1BgL,EAAc7M,KAAKxB,EAAQ,IAG7B,GAAIqO,EAAchP,OAAQ,CACxB,MAAMiP,EApBD,CACLN,EAAU,mBACVA,EAAU,wBACVA,EAAU,4BACVA,EAAU,yBAkBV,IAAK,IAAI5O,EAAE,EAAGA,EAAIiP,EAAchP,OAAQD,IAAK,CAC3C,MAAMwH,EAAWyH,EAAcjP,GAC/B,IAAIyM,GAAc,EAElB,IAAK,IAAIC,EAAE,EAAGA,EAAIwC,EAAmBjP,OAAQyM,IAG3C,GAFAmC,EAAQK,EAAmBxC,GAEvBmC,EAAM1I,KAAKqB,GAAW,CACxBiF,GAAc,EACd,KACF,CAGGA,GACHD,EAAchF,EAElB,CACF,CACF,EA4EED,iBA1EuB,SAAStD,EAAYuI,EAAepN,EAAK0H,EAAWC,EAAoBC,EAAqB7C,GACpH,IAAKF,GAAwC,mBAAlBuI,EAA+B,OAErD1F,IACHA,EAAY,CAAC,GAEfkI,EAAuB5P,EAAK0H,GAE5B,MAAMqI,EAAe,CAAC,eAAgB,eAAgB,SAAU,cAAe,kBAAmB,eAClG,IACIxG,EAAakG,EAAOjO,EAASwO,EAAoBC,EAAoBC,EADrEhI,EAAqBrD,EAGzB,IAAK,IAAIjE,EAAE,EAAGA,EAAImP,EAAalP,OAAQD,IAIrC,IAHA2I,EAAcwG,EAAanP,GAC3B6O,EAAcD,EAAUjG,EAAc,aAE/B/H,EAAUiO,EAAMhO,KAAKoD,IAAa,CACvCmL,EAAqBxO,EAAQ,GAC7ByO,EAAqBzO,EAAQ,GAE7B,IACE,OAAO+H,GACL,IAAK,eAED2G,EAAsBvI,EADAa,SAASyH,EAAoB,KAEnDC,EAAsBpH,EAAGsG,qBAAqBc,EAAkBnL,GAElE,MACF,IAAK,eAEDmL,EAAsBtI,EADAY,SAASyH,EAAoB,KAEnDC,EAAsBpH,EAAGsG,qBAAqBc,EAAkBnL,GAElE,MACF,QACEmL,EAAmBxI,EAAU6B,GAAa0G,GAI9C,QAAyB9N,IAArB+N,EAAgC,KAAM,GAE1ChI,EAAqBA,EAAmBiI,WAAWH,EAAoBE,EACzE,CACA,MAAM1L,GACJ4I,EAAc4C,EAAoBzG,EACpC,CACF,CAGF,OAAOrB,CACT,E,gBCrHA,MAAMkI,EAAkBxK,EAAQ,KAEhCtB,EAAOC,QAAU6L,C,GCDbC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBpO,IAAjBqO,EACH,OAAOA,EAAajM,QAGrB,IAAID,EAAS+L,EAAyBE,GAAY,CACjDE,GAAIF,EACJG,QAAQ,EACRnM,QAAS,CAAC,GAUX,OANAoM,EAAoBJ,GAAUjM,EAAQA,EAAOC,QAAS+L,GAGtDhM,EAAOoM,QAAS,EAGTpM,EAAOC,OACf,CCzBA+L,EAAoBM,IAAOtM,IAC1BA,EAAOuM,MAAQ,GACVvM,EAAOwM,WAAUxM,EAAOwM,SAAW,IACjCxM,GCHRG,OAAO2L,gBAAkBxK,EAAQ,I","sources":["webpack://@warren-bank/htaccess-tester/./node_modules/@warren-bank/url/es6-node/jsURL.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-parser/model/HtaccessFile.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-parser/model/RewriteCond.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-parser/model/RewriteRule.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-parser/parser.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/model/RewriteCond.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/model/RewriteRule.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/tester.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/util/file-helper.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/util/flag-validator.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/util/url-helper.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/util/variable-interpolator.js","webpack://@warren-bank/htaccess-tester/../lib/index.js","webpack://@warren-bank/htaccess-tester/webpack/bootstrap","webpack://@warren-bank/htaccess-tester/webpack/runtime/node module decorator","webpack://@warren-bank/htaccess-tester/./src/globals.js"],"sourcesContent":["const regexs = {\r\n  url:  new RegExp('^([^/:]+:)?(?://(?:([^/:@]+):?([^/:@]+)?@)?([^:/\\\\?#]+)(?::(\\\\d+))?)?(/[^\\\\?#]*|[^\\\\?#]+)?(\\\\?[^#]*)?(#.*)?$'),\r\n  host: /^([^:]+)(?::(\\d+))?$/\r\n}\r\n\r\nclass URL {\r\n  #_searchParams = ''\r\n\r\n  constructor(url, base) {\r\n    if (base)\r\n      url = URL.resolve(url, base) || ''\r\n\r\n    this.href = url\r\n  }\r\n\r\n  static resolve(url, base) {\r\n    const srcURL = new URL(base)\r\n    const dstURL = new URL(url)\r\n\r\n    const fields = ['protocol', 'username', 'password', 'hostname', 'port', 'pathname', 'search', 'hash']\r\n\r\n    // copy missing fields in order, and stop when the 1st populated field is encountered.\r\n    // when the 1st populated field is pathname, do the equivalent to: path.join(base_pathname, url_pathname)\r\n    for (let i=0; i < fields.length; i++) {\r\n      let field = fields[i]\r\n\r\n      if ((field === 'pathname') && dstURL[field] && srcURL[field] && (dstURL[field][0] !== '/'))\r\n        dstURL[field] = srcURL[field].replace(/[^\\/]*$/, '') + dstURL[field]\r\n      if (dstURL[field])\r\n        break\r\n      if (srcURL[field])\r\n        dstURL[field] = srcURL[field]\r\n    }\r\n\r\n    return dstURL.toString()\r\n  }\r\n\r\n  toString() {\r\n    return `${this.protocol}${this.host ? `//${this.username ? (this.password ? `${this.username}:${this.password}@` : `${this.username}@`) : ''}${this.host}` : ''}${this.pathname}${this.search}${this.hash}`\r\n  }\r\n\r\n  toJSON() {\r\n    return this.toString()\r\n  }\r\n\r\n  get href() {\r\n    return this.toString()\r\n  }\r\n\r\n  set href(url) {\r\n    const matches = regexs.url.exec(url)\r\n    if (!matches) throw new Error(\"Failed to construct 'URL': Invalid URL\")\r\n\r\n    this.protocol     = matches[1] || ''\r\n    this.username     = matches[2] || ''\r\n    this.password     = matches[3] || ''\r\n    this.hostname     = matches[4] || ''\r\n    this.port         = matches[5] || ''\r\n    this.pathname     = matches[6] || ''\r\n    this.search       = matches[7] || ''\r\n    this.hash         = matches[8] || ''\r\n  }\r\n\r\n  get host() {\r\n    return this.port ? `${this.hostname}:${this.port}` : this.hostname\r\n  }\r\n\r\n  set host(host) {\r\n    const matches = regexs.host.exec(host)\r\n    if (!matches) throw new Error(\"Failed to update 'URL': Invalid host\")\r\n\r\n    this.hostname     = matches[1] || ''\r\n    this.port         = matches[2] || ''\r\n  }\r\n\r\n  // read-only\r\n  get origin() {\r\n    return `${this.protocol}//${this.host}`\r\n  }\r\n\r\n  get search() {\r\n    return this.#_searchParams.toString()\r\n  }\r\n\r\n  set search(search) {\r\n    this.#_searchParams = new URLSearchParams(search)\r\n  }\r\n\r\n  // read-only\r\n  get searchParams() {\r\n    return this.#_searchParams\r\n  }\r\n\r\n  // ===================\r\n  // additional methods:\r\n  // ===================\r\n\r\n  parse(parseQueryString = false) {\r\n    return {\r\n      slashes:  true,\r\n      href:     this.href,\r\n      protocol: this.protocol,\r\n      username: this.username,\r\n      password: this.password,\r\n      auth:     `${this.username ? (this.password ? `${this.username}:${this.password}` : `${this.username}`) : ''}`,\r\n      hostname: this.hostname,\r\n      port:     this.port,\r\n      host:     this.host,\r\n      pathname: this.pathname,\r\n      search:   this.search,\r\n      path:     `${this.pathname}${this.search}`,\r\n      query:    (parseQueryString ? this.searchParams.parse() : this.searchParams.toString(/* exclude_question_mark= */ true)),\r\n      hash:     this.hash\r\n    }\r\n  }\r\n}\r\n\r\nclass URLSearchParams {\r\n  #_map    = {}\r\n  #_sorted = false\r\n\r\n  constructor(search) {\r\n    this.#_map = {}\r\n\r\n    if (search && (search[0] === '?'))\r\n      search = search.substring(1)\r\n\r\n    if (search) {\r\n      const pairs = search.split('&')\r\n      pairs.forEach(pair => {\r\n        const index = pair.indexOf('=')\r\n\r\n        if (index > 0) {\r\n          const key = pair.substring(0, index)\r\n          const val = (index + 1 < pair.length) ? pair.substring(index + 1) : ''\r\n\r\n          if (!this.#_map[key])\r\n            this.#_map[key] = []\r\n\r\n          this.#_map[key].push(val)\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  has(key) {\r\n    return !!this.#_map[key]\r\n  }\r\n\r\n  get(key) {\r\n    return this.#_map[key] ? this.#_map[key][0] : null\r\n  }\r\n\r\n  getAll(key) {\r\n    return this.#_map[key] ? [...this.#_map[key]] : []\r\n  }\r\n\r\n  set(key, val) {\r\n    this.#_map[key] = [val]\r\n  }\r\n\r\n  append(key, val) {\r\n    if (!this.#_map[key])\r\n      this.#_map[key] = []\r\n\r\n    this.#_map[key].push(val)\r\n  }\r\n\r\n  delete(key, val) {\r\n    if (!this.#_map[key]) return\r\n\r\n    if (val) {\r\n      const index = this.#_map[key].indexOf(val)\r\n      if (index >= 0) {\r\n        this.#_map[key].splice(index, 1)\r\n\r\n        if (!this.#_map[key].length)\r\n          delete this.#_map[key]\r\n      }\r\n    }\r\n    else {\r\n      delete this.#_map[key]\r\n    }\r\n  }\r\n\r\n  sort(sorted = true) {\r\n    this.#_sorted = !!sorted\r\n  }\r\n\r\n  keys() {\r\n    const keys = Object.keys(this.#_map)\r\n    if (this.#_sorted) keys.sort()\r\n    return keys\r\n  }\r\n\r\n  values() {\r\n    const values = []\r\n    for (const key in this.#_map) {\r\n      values.push(...this.#_map[key])\r\n    }\r\n    if (this.#_sorted) values.sort()\r\n    return values\r\n  }\r\n\r\n  entries() {\r\n    const denormalized = []\r\n    const keys = this.keys()\r\n    keys.forEach(key => {\r\n      const vals = this.#_sorted\r\n        ? [...this.#_map[key]].sort()\r\n        : this.#_map[key]\r\n      vals.forEach(val => {\r\n        denormalized.push([key, val])\r\n      })\r\n    })\r\n    return denormalized\r\n  }\r\n\r\n  forEach(callback, thisArg) {\r\n    const denormalized = this.entries()\r\n    denormalized.forEach(([key, val]) => {\r\n      callback.apply(thisArg, [val, key, this])\r\n    })\r\n  }\r\n\r\n  toString(exclude_question_mark = false) {\r\n    let search = ''\r\n    const denormalized = this.entries()\r\n    denormalized.forEach(([key, val]) => {\r\n      let prefix = search ? '&' : exclude_question_mark ? '' : '?'\r\n      search += `${prefix}${key}=${val}`\r\n    })\r\n    return search\r\n  }\r\n\r\n  toJSON() {\r\n    return this.toString()\r\n  }\r\n\r\n  // ===================\r\n  // additional methods:\r\n  // ===================\r\n\r\n  parse() {\r\n    const map_clone = {}\r\n    for (const key in this.#_map) {\r\n      map_clone[key] = [...this.#_map[key]]\r\n    }\r\n    return map_clone\r\n  }\r\n}\r\n\r\nconst parse = (url, parseQueryString = false) => {\r\n  return (new URL(url)).parse(parseQueryString)\r\n}\r\n\r\nconst resolve = (base, url) => URL.resolve(url, base)\r\n\r\ntry {\r\n  if (module instanceof Object)\r\n    module.exports = {URL, URLSearchParams, parse, resolve}\r\n}\r\ncatch(e) {}\r\n\r\ntry {\r\n  if (window instanceof Object)\r\n    window.jsURL = {URL, URLSearchParams, parse, resolve}\r\n}\r\ncatch(e) {}\r\n","function HtaccessFile() {\r\n  this.RewriteRules = []\r\n}\r\n\r\nmodule.exports = HtaccessFile\r\n","function RewriteCond(text, testString, condPattern, flags) {\r\n  this.text        = text\r\n  this.testString  = testString\r\n  this.condPattern = condPattern\r\n  this.flags       = flags.replace('[', '').replace(']', '').split(',')\r\n    .map(Function.prototype.call, String.prototype.trim)\r\n    .filter(function (flag) {\r\n      return (flag.length > 0)\r\n    })\r\n}\r\n\r\nmodule.exports = RewriteCond\r\n","function RewriteRule(text, pattern, substitution, flags, conditions) {\r\n  this.text         = text\r\n  this.pattern      = pattern\r\n  this.substitution = substitution\r\n  this.flags        = flags.replace('[', '').replace(']', '').split(',')\r\n    .map(Function.prototype.call, String.prototype.trim)\r\n    .filter(function (flag) {\r\n      return (flag.length > 0)\r\n    })\r\n  this.conditions   = conditions || []\r\n}\r\n\r\nmodule.exports = RewriteRule\r\n","const HtaccessFile = require('./model/HtaccessFile')\r\nconst RewriteRule = require('./model/RewriteRule')\r\nconst RewriteCond = require('./model/RewriteCond')\r\n\r\nfunction Parser(content) {\r\n  if (!Array.isArray(content)) {\r\n    content = content.toString().split('\\n')\r\n  }\r\n\r\n  this.content = content.filter(function (line) {\r\n    const trimmed = line.trim()\r\n    return (trimmed.length > 0) && (trimmed.substring(0, 1) !== '#')\r\n  })\r\n\r\n  return this.parseContent()\r\n}\r\n\r\nParser.prototype.parseContent = function () {\r\n  const htaccessFile = new HtaccessFile()\r\n\r\n  let RewriteEngineActivated = false\r\n  let conditions = []\r\n  let flags = null\r\n\r\n  for (let i=0; i < this.content.length; i++) {\r\n    const line = this.content[i].trim()\r\n    const parts = line.trim().split(' ').filter(function (part) {\r\n      return part.length > 0\r\n    })\r\n\r\n    const directive = parts[0]\r\n\r\n    switch(directive) {\r\n      case 'RewriteEngine':\r\n        RewriteEngineActivated = (this.stripQuotes(parts[1]).toLowerCase() === 'on')\r\n        break\r\n\r\n      case 'RewriteBase':\r\n        if (RewriteEngineActivated) {\r\n          htaccessFile.RewriteBase = this.stripQuotes(parts[1])\r\n        }\r\n        break\r\n\r\n      case 'RewriteCond':\r\n        if (RewriteEngineActivated) {\r\n          flags = (typeof parts[3] === 'undefined' ? '' : parts[3])\r\n          conditions.push(new RewriteCond(line, this.stripQuotes(parts[1]), this.stripQuotes(parts[2]), flags))\r\n        }\r\n        break\r\n\r\n      case 'RewriteRule':\r\n        if (RewriteEngineActivated) {\r\n          flags = (typeof parts[3] === 'undefined' ? '' : parts[3])\r\n          const rule = new RewriteRule(line, this.stripQuotes(parts[1]), this.stripQuotes(parts[2]), flags, conditions)\r\n\r\n          htaccessFile.RewriteRules.push(rule)\r\n          conditions = []\r\n        }\r\n        break\r\n    }\r\n  }\r\n\r\n  return htaccessFile\r\n}\r\n\r\nParser.prototype.stripQuotes = function (s) {\r\n  return (/^\"([^\"]*)\"$/.test(s) || /^'([^']*)'$/.test(s))\r\n    ? s.slice(1, -1)\r\n    : s\r\n}\r\n\r\nmodule.exports = function (content) {\r\n  return (new Parser(content))\r\n}\r\n","// references:\r\n//   https://httpd.apache.org/docs/2.4/mod/mod_rewrite.html#rewritecond\r\n\r\nconst vi = require('../util/variable-interpolator')\r\nconst fv = require('../util/flag-validator')\r\n\r\nconst regexs = {\r\n  \"lexicographical-operation\": /^(<|>|=|<=|>=)(.*)$/,\r\n  \"integer-operation\":         /^(-eq|-ge|-gt|-le|-lt|-ne)(.*)$/\r\n}\r\n\r\nconst supportedFlags = [\r\n  'NC', 'nocase',\r\n  'OR', 'ornext'\r\n]\r\n\r\nfunction RewriteCond(baseCondition) {\r\n  Object.assign(this, baseCondition)\r\n\r\n  this.condPatternFlags = {\r\n    \"negate\": false,\r\n    \"lexicographical-operation\": null,\r\n    \"integer-operation\": null\r\n  }\r\n\r\n  if (this.condPattern && (this.condPattern[0] === '!')) {\r\n    this.condPatternFlags['negate'] = true\r\n    this.condPattern = this.condPattern.substring(1)\r\n  }\r\n\r\n  if (this.condPattern) {\r\n    const matches = regexs[\"lexicographical-operation\"].exec(this.condPattern)\r\n\r\n    if (matches) {\r\n      this.condPatternFlags['lexicographical-operation'] = matches[1]\r\n      this.condPattern = matches[2]\r\n    }\r\n  }\r\n\r\n  if (this.condPattern && !this.condPatternFlags['lexicographical-operation']) {\r\n    const matches = regexs[\"integer-operation\"].exec(this.condPattern)\r\n\r\n    if (matches) {\r\n      this.condPatternFlags['integer-operation'] = matches[1]\r\n      this.condPattern = matches[2]\r\n    }\r\n  }\r\n\r\n  if (this.condPattern && !this.condPatternFlags['lexicographical-operation'] && !this.condPatternFlags['integer-operation']) {\r\n    this.re = this.isNC()\r\n      ? new RegExp(this.condPattern, 'i')\r\n      : new RegExp(this.condPattern)\r\n  }\r\n}\r\n\r\nRewriteCond.prototype.runTest = function (url, variables, currentRuleMatches, previousCondMatches) {\r\n  const log = {\r\n    \"text\":         this.text,\r\n    \"is_condition\": true\r\n  }\r\n\r\n  log.errors = this.isValid()\r\n\r\n  if (log.errors && log.errors.length) {\r\n    log.is_valid = false\r\n    log.is_match = false\r\n    return log\r\n  }\r\n\r\n  const resolvedTestString = vi.resolveVariables(\r\n    this.testString,\r\n    function(variable) {\r\n      log.errors.push('RewriteCond TestString variable not resolved: ' + variable)\r\n    },\r\n    url, variables, currentRuleMatches, previousCondMatches\r\n  )\r\n\r\n  if (log.errors && log.errors.length) {\r\n    log.is_valid = false\r\n    log.is_match = false\r\n    return log\r\n  }\r\n\r\n  log.is_valid = true\r\n  log.result = {\r\n    \"TestString\":       resolvedTestString,\r\n    \"CondPatternFlags\": Object.assign({}, this.condPatternFlags)\r\n  }\r\n\r\n  if (this.condPatternFlags['lexicographical-operation']) {\r\n    const testVal = resolvedTestString\r\n    const condVal = this.condPattern\r\n\r\n    switch(this.condPatternFlags['lexicographical-operation']) {\r\n      case '<':\r\n        log.is_match = (testVal < condVal)\r\n        break\r\n      case '>':\r\n        log.is_match = (testVal > condVal)\r\n        break\r\n      case '=':\r\n        log.is_match = (testVal == condVal)\r\n        break\r\n      case '<=':\r\n        log.is_match = (testVal <= condVal)\r\n        break\r\n      case '>=':\r\n        log.is_match = (testVal >= condVal)\r\n        break\r\n      default:\r\n        log.is_match = false\r\n    }\r\n  }\r\n\r\n  else if (this.condPatternFlags['integer-operation']) {\r\n    const testVal = parseInt(resolvedTestString, 10)\r\n    const condVal = parseInt(this.condPattern,   10)\r\n\r\n    switch(this.condPatternFlags['integer-operation']) {\r\n      case '-eq':\r\n        log.is_match = (testVal == condVal)\r\n        break\r\n      case '-ge':\r\n        log.is_match = (testVal >= condVal)\r\n        break\r\n      case '-gt':\r\n        log.is_match = (testVal > condVal)\r\n        break\r\n      case '-le':\r\n        log.is_match = (testVal <= condVal)\r\n        break\r\n      case '-lt':\r\n        log.is_match = (testVal < condVal)\r\n        break\r\n      case '-ne':\r\n        log.is_match = (testVal != condVal)\r\n        break\r\n      default:\r\n        log.is_match = false\r\n    }\r\n  }\r\n\r\n  else {\r\n    matches = this.re.exec(resolvedTestString)\r\n\r\n    log.is_match = !!matches\r\n\r\n    if (matches)\r\n      log.result.matches = matches.slice()\r\n  }\r\n\r\n  if (this.condPatternFlags['negate'])\r\n    log.is_match = !log.is_match\r\n\r\n  return log\r\n}\r\n\r\nRewriteCond.prototype.isValid = function () {\r\n  const errors = []\r\n\r\n  this.isValidTestString(errors)\r\n  this.isValidFlags(errors)\r\n\r\n  return errors\r\n}\r\n\r\nRewriteCond.prototype.isValidTestString = function (errors) {\r\n  // special case\r\n  if (this.testString === 'expr') {\r\n    errors.push('RewriteCond TestString not supported: ' + this.testString)\r\n    return\r\n  }\r\n\r\n  vi.isValid(\r\n    this.testString,\r\n    function(variable) {\r\n      errors.push('RewriteCond TestString variable not supported: ' + variable)\r\n    }\r\n  )\r\n}\r\n\r\nRewriteCond.prototype.isValidFlags = function (errors) {\r\n  fv.isValid(\r\n    this.flags,\r\n    supportedFlags,\r\n    function(flag) {\r\n      errors.push('RewriteCond flag not supported: ' + flag)\r\n    }\r\n  )\r\n}\r\n\r\nRewriteCond.prototype.isNC = function () {\r\n  return fv.hasFlag(this.flags, 'NC')\r\n    ||   fv.hasFlag(this.flags, 'nocase')\r\n}\r\n\r\nRewriteCond.prototype.isOR = function () {\r\n  return fv.hasFlag(this.flags, 'OR')\r\n    ||   fv.hasFlag(this.flags, 'ornext')\r\n}\r\n\r\nmodule.exports = RewriteCond\r\n","// references:\r\n//   https://httpd.apache.org/docs/2.4/mod/mod_rewrite.html#rewriterule\r\n\r\nconst RewriteCond = require('./RewriteCond')\r\nconst vi          = require('../util/variable-interpolator')\r\nconst fv          = require('../util/flag-validator')\r\nconst fh          = require('../util/file-helper')\r\nconst uh          = require('../util/url-helper')\r\n\r\nconst supportedFlags = [\r\n  'B', /^B=(.+)$/,\r\n  'BCTLS',\r\n  /^BNE=(.+)$/,\r\n  'BNP', 'backrefnoplus',\r\n  'END',\r\n  'F', 'forbidden',\r\n  'G', 'gone',\r\n  'L', 'last',\r\n  'N', /^N=(\\d+)$/, 'next', /^next=(\\d+)$/,\r\n  'NC', 'nocase',\r\n  'PT', 'passthrough',\r\n  'QSA', 'qsappend',\r\n  'QSD', 'qsdiscard',\r\n  'QSL', 'qslast',\r\n  'R', /^R=(\\d{3})$/, 'redirect', /^redirect=(\\d{3})$/,\r\n  'S', /^S=(\\d+)$/, 'skip', /^skip=(\\d+)$/,\r\n  /^T=(.+)$/, /^type=(.+)$/\r\n]\r\n\r\nfunction RewriteRule(baseRule) {\r\n  Object.assign(this, baseRule)\r\n\r\n  for (let i=0; i < this.conditions.length; i++) {\r\n    this.conditions[i] = new RewriteCond(this.conditions[i])\r\n  }\r\n\r\n  this.re = this.isNC()\r\n    ? new RegExp(this.pattern, 'i')\r\n    : new RegExp(this.pattern)\r\n}\r\n\r\nRewriteRule.prototype.runAllTests = function (url, variables) {\r\n  const currentRuleMatches = this.re.exec(uh.get_parsed_pathname(true, true))\r\n  let previousCondMatches  = null\r\n  const logs = []\r\n\r\n  for (let i=0; i < this.conditions.length; i++) {\r\n    const log = this.conditions[i].runTest(url, variables, currentRuleMatches, previousCondMatches)\r\n\r\n    previousCondMatches = (log.result && log.result.matches)\r\n      ? log.result.matches\r\n      : null\r\n\r\n    logs.push(log)\r\n  }\r\n\r\n  logs.push(\r\n    this.runTest(url, variables, currentRuleMatches, previousCondMatches, this.doAllConditionsMatch(logs))\r\n  )\r\n\r\n  return logs\r\n}\r\n\r\nRewriteRule.prototype.runTest = function (url, variables, currentRuleMatches, previousCondMatches, allConditionsMatch) {\r\n  const log = {\r\n    \"text\":         this.text,\r\n    \"is_condition\": false\r\n  }\r\n\r\n  log.errors = this.isValid()\r\n\r\n  if (log.errors && log.errors.length) {\r\n    log.is_valid = false\r\n    log.is_match = false\r\n    return log\r\n  }\r\n\r\n  let new_url\r\n  if (this.substitution === '-') {\r\n    new_url = url\r\n  }\r\n  else {\r\n    const resolvedSubstitutionString = vi.resolveVariables(\r\n      this.substitution,\r\n      function(variable, variableKey) {\r\n        if ((variableKey === 'backref-rule') && !currentRuleMatches) return\r\n\r\n        log.errors.push('RewriteRule Substitution variable not resolved: ' + variable)\r\n      },\r\n      url, variables, currentRuleMatches, previousCondMatches,\r\n      this.get_backref_format_flags()\r\n    )\r\n\r\n    new_url = uh.update_querystring(\r\n      url, resolvedSubstitutionString,\r\n      this.isQSL(), this.isQSD(), this.isQSA()\r\n    )\r\n  }\r\n\r\n  if (log.errors && log.errors.length) {\r\n    log.is_valid = false\r\n    log.is_match = false\r\n    return log\r\n  }\r\n\r\n  log.is_valid = true\r\n  log.is_match = !!currentRuleMatches\r\n  log.all_conditions_match = allConditionsMatch\r\n  log.result = {\r\n    \"url\":         new_url,\r\n    \"status_code\": (this.getStatusCode() || this.getRedirectStatusCode() || null),\r\n    \"mime_type\":   this.getMimeType(),\r\n    \"skip_count\":  this.getSkipCount()\r\n  }\r\n\r\n  if (currentRuleMatches)\r\n    log.result.matches = currentRuleMatches.slice()\r\n\r\n  log.is_redirect = (\r\n       log.result.status_code\r\n   && (log.result.status_code >= 300)\r\n   && (log.result.status_code <  400)\r\n  )\r\n\r\n  if (!log.is_redirect && uh.is_redirect_url(new_url)) {\r\n    log.is_redirect        = true\r\n    log.result.status_code = 302\r\n  }\r\n\r\n  log.is_passthrough = this.isPassThrough()\r\n  log.is_last        = this.isLast()\r\n\r\n  let nextCount = (!log.is_valid || !log.is_match || (this.substitution === '-'))\r\n    ? 0\r\n    : this.getNextCount()\r\n\r\n  while ((nextCount > 0) && this.runNext(log, variables, previousCondMatches)) {\r\n    nextCount--\r\n  }\r\n\r\n  return log\r\n}\r\n\r\nRewriteRule.prototype.runNext = function (log, variables, previousCondMatches) {\r\n  const currentRuleMatches = this.re.exec(uh.trim_lead_slash(log.result.url))\r\n  if (!currentRuleMatches) return false\r\n\r\n  const url = uh.get_resolved_url(log.result.url)\r\n  let OK = true\r\n\r\n  const resolvedSubstitutionString = vi.resolveVariables(\r\n    this.substitution,\r\n    function(variable) {\r\n      OK = false\r\n    },\r\n    url, variables, currentRuleMatches, previousCondMatches,\r\n    this.get_backref_format_flags()\r\n  )\r\n\r\n  const new_url = uh.update_querystring(\r\n    url, resolvedSubstitutionString,\r\n    this.isQSL(), this.isQSD(), this.isQSA()\r\n  )\r\n\r\n  if (OK) {\r\n    if (!log.result['next'])\r\n      log.result['next'] = {\"count\": 0, \"iterations\": []}\r\n\r\n    log.result['next'].count++\r\n    log.result['next'].iterations.push({\r\n      \"url\":       url,\r\n      \"file_path\": fh.get_resolved_filepath(log.result.url),\r\n      \"matches\":   log.result.matches\r\n    })\r\n\r\n    log.result.url     = new_url\r\n    log.result.matches = currentRuleMatches.slice()\r\n  }\r\n\r\n  return OK\r\n}\r\n\r\nRewriteRule.prototype.isValid = function () {\r\n  const errors = []\r\n\r\n  this.isValidSubstitutionString(errors)\r\n  this.isValidFlags(errors)\r\n\r\n  return errors\r\n}\r\n\r\nRewriteRule.prototype.isValidSubstitutionString = function (errors) {\r\n  vi.isValid(\r\n    this.substitution,\r\n    function(variable) {\r\n      errors.push('RewriteRule Substitution variable not supported: ' + variable)\r\n    }\r\n  )\r\n}\r\n\r\nRewriteRule.prototype.isValidFlags = function (errors) {\r\n  fv.isValid(\r\n    this.flags,\r\n    supportedFlags,\r\n    function(flag) {\r\n      errors.push('RewriteRule flag not supported: ' + flag)\r\n    }\r\n  )\r\n}\r\n\r\nRewriteRule.prototype.doAllConditionsMatch = function (logs) {\r\n  const state = {\r\n    currentIsOr:    false,\r\n    prevWasOr:      false,\r\n    orConditionMet: false\r\n  }\r\n\r\n  for (let i=0; i < this.conditions.length; i++) {\r\n    state.currentIsOr = this.conditions[i].isOR()\r\n\r\n    // one of the OR condition has been met\r\n    if (state.prevWasOr && state.orConditionMet) {\r\n      state.prevWasOr      = state.currentIsOr\r\n      state.orConditionMet = state.currentIsOr\r\n      continue\r\n    }\r\n\r\n    // condition isn't met\r\n    if (!logs[i].is_match) {\r\n      if (state.currentIsOr) {\r\n        continue\r\n      }\r\n      else {\r\n        return false\r\n      }\r\n    }\r\n    else if (state.currentIsOr) {\r\n      state.orConditionMet = true\r\n      state.prevWasOr      = state.currentIsOr\r\n    }\r\n  }\r\n\r\n  return true\r\n}\r\n\r\nRewriteRule.prototype.getStatusCode = function () {\r\n  if (\r\n         (this.flags.indexOf('F')         !== -1)\r\n    ||   (this.flags.indexOf('forbidden') !== -1)\r\n  )\r\n    return 403\r\n\r\n  if (\r\n         (this.flags.indexOf('G')    !== -1)\r\n    ||   (this.flags.indexOf('gone') !== -1)\r\n  )\r\n    return 410\r\n\r\n  return 0\r\n}\r\n\r\nRewriteRule.prototype.getRedirectStatusCode = function () {\r\n  return fv.getFlagIntegerValue(this.flags, 'R',        302)\r\n    ||   fv.getFlagIntegerValue(this.flags, 'redirect', 302)\r\n}\r\n\r\nRewriteRule.prototype.getSkipCount = function () {\r\n  return fv.getFlagIntegerValue(this.flags, 'S',    0)\r\n    ||   fv.getFlagIntegerValue(this.flags, 'skip', 0)\r\n}\r\n\r\nRewriteRule.prototype.getNextCount = function () {\r\n  return fv.getFlagIntegerValue(this.flags, 'N',    10000)\r\n    ||   fv.getFlagIntegerValue(this.flags, 'next', 10000)\r\n}\r\n\r\nRewriteRule.prototype.getMimeType = function () {\r\n  return fv.getFlagStringValue(this.flags, 'T')\r\n    ||   fv.getFlagStringValue(this.flags, 'type')\r\n}\r\n\r\nRewriteRule.prototype.getB = function () {\r\n  return fv.getFlagStringValue(this.flags, 'B')\r\n    ||   fv.hasFlag(this.flags, 'B')\r\n}\r\n\r\nRewriteRule.prototype.getBNE = function () {\r\n  return fv.getFlagStringValue(this.flags, 'BNE')\r\n}\r\n\r\nRewriteRule.prototype.isBCTLS = function () {\r\n  return fv.hasFlag(this.flags, 'BCTLS')\r\n}\r\n\r\nRewriteRule.prototype.isBNP = function () {\r\n  return fv.hasFlag(this.flags, 'BNP')\r\n    ||   fv.hasFlag(this.flags, 'backrefnoplus')\r\n}\r\n\r\nRewriteRule.prototype.isNC = function () {\r\n  return fv.hasFlag(this.flags, 'NC')\r\n    ||   fv.hasFlag(this.flags, 'nocase')\r\n}\r\n\r\nRewriteRule.prototype.isQSA = function () {\r\n  return fv.hasFlag(this.flags, 'QSA')\r\n    ||   fv.hasFlag(this.flags, 'qsappend')\r\n}\r\n\r\nRewriteRule.prototype.isQSD = function () {\r\n  return fv.hasFlag(this.flags, 'QSD')\r\n    ||   fv.hasFlag(this.flags, 'qsdiscard')\r\n}\r\n\r\nRewriteRule.prototype.isQSL = function () {\r\n  return fv.hasFlag(this.flags, 'QSL')\r\n    ||   fv.hasFlag(this.flags, 'qslast')\r\n}\r\n\r\nRewriteRule.prototype.isPassThrough = function () {\r\n  return fv.hasFlag(this.flags, 'PT')\r\n    ||   fv.hasFlag(this.flags, 'passthrough')\r\n}\r\n\r\nRewriteRule.prototype.isLast = function () {\r\n  return fv.hasFlag(this.flags, 'L')\r\n    ||   fv.hasFlag(this.flags, 'last')\r\n    ||   fv.hasFlag(this.flags, 'END')\r\n}\r\n\r\nRewriteRule.prototype.get_backref_format_flags = function () {\r\n  return {\r\n    \"B\":     this.getB(),\r\n    \"BNE\":   this.getBNE(),\r\n    \"BCTLS\": this.isBCTLS(),\r\n    \"BNP\":   this.isBNP()\r\n  }\r\n}\r\n\r\nmodule.exports = RewriteRule\r\n","const RewriteRule    = require('./model/RewriteRule')\r\nconst fh             = require('./util/file-helper')\r\nconst uh             = require('./util/url-helper')\r\nconst htaccessParser = require('../htaccess-parser/parser')\r\n\r\nfunction HtaccessTester(test_data) {\r\n  this.test_data = test_data\r\n\r\n  return this.runTest()\r\n}\r\n\r\nHtaccessTester.prototype.runTest = function () {\r\n  this.test_results = {}\r\n\r\n  try {\r\n    this.parseContent()\r\n\r\n    fh.setRewriteBase(\r\n      this.htaccessFile.RewriteBase\r\n    )\r\n\r\n    this.rules = []\r\n    for (let i=0; i < this.htaccessFile.RewriteRules.length; i++) {\r\n      const rule = new RewriteRule(\r\n        this.htaccessFile.RewriteRules[i]\r\n      )\r\n \r\n     this.rules.push(rule)\r\n    }\r\n\r\n    const {result, log} = this.processAllRules(\r\n      this.test_data.url,\r\n      this.test_data.variables\r\n    )\r\n\r\n    this.test_results.success = true\r\n    this.test_results.result  = result\r\n    this.test_results.log     = log\r\n  }\r\n  catch(e) {\r\n    this.test_results.success = false\r\n    this.test_results.error   = e.message\r\n  }\r\n\r\n  return this.test_results\r\n}\r\n\r\nHtaccessTester.prototype.parseContent = function () {\r\n  let htaccessContent = this.test_data.htaccess\r\n\r\n  this.htaccessFile = htaccessParser(htaccessContent)\r\n}\r\n\r\nHtaccessTester.prototype.processAllRules = function (url, variables) {\r\n  uh.parse_url(url)\r\n\r\n  const allLogs   = []\r\n  let finalResult = null\r\n  let skip_count  = 0\r\n\r\n  for (let i=0; i < this.rules.length; i++) {\r\n    const rule     = this.rules[i]\r\n    const someLogs = rule.runAllTests(url, variables)\r\n\r\n    if (!someLogs || !someLogs.length) continue\r\n    allLogs.push(someLogs)\r\n\r\n    const log = someLogs[someLogs.length - 1]\r\n\r\n    if (skip_count > 0) {\r\n      log.is_skipped = true\r\n      skip_count--\r\n      continue\r\n    }\r\n\r\n    if (!log.is_valid || !log.is_match) continue\r\n\r\n    if (log.result)\r\n      finalResult = log.result\r\n\r\n    if (log.result && log.result.skip_count)\r\n      skip_count += log.result.skip_count\r\n\r\n    if (log.result && log.result.url) {\r\n      log.result.file_path = fh.get_resolved_filepath(log.result.url)\r\n      log.result.url       = uh.get_resolved_url(log.result.url)\r\n      url = log.result.url\r\n\r\n      if (log.is_passthrough) {\r\n        const data = this.processAllRules(url, variables)\r\n\r\n        log['passthrough'] = data.log\r\n        finalResult = data.result || finalResult\r\n        break\r\n      }\r\n    }\r\n\r\n    if (log.result && log.result.status_code && !log.is_redirect) break\r\n\r\n    if (log.is_last) break\r\n  }\r\n\r\n  return {\r\n    \"result\": finalResult,\r\n    \"log\":    Array.prototype.concat.apply([], allLogs)\r\n  }\r\n}\r\n\r\nmodule.exports = function (test_data) {\r\n  return (new HtaccessTester(test_data))\r\n}\r\n","let RewriteBase = '/'\r\n\r\nconst setRewriteBase = function(rb) {\r\n  RewriteBase = rb || '/'\r\n}\r\n\r\nconst get_resolved_filepath = function(relative_path) {\r\n  if (!relative_path)\r\n    relative_path = ''\r\n  if (relative_path.substring(0,4).toLowerCase() === 'http')\r\n    return null\r\n\r\n  return (RewriteBase && (relative_path.indexOf(RewriteBase) !== 0))\r\n    ? (RewriteBase + '/' + relative_path).replace(/[\\/]{2,}/g, '/')\r\n    : relative_path\r\n}\r\n\r\nmodule.exports = {\r\n  setRewriteBase,\r\n  get_resolved_filepath\r\n}\r\n","const isValid = function (flags, supportedFlags, errorCallback) {\r\n  if (!Array.isArray(supportedFlags) || !supportedFlags.length || (typeof errorCallback !== 'function')) return\r\n\r\n  for (let i=0; i < flags.length; i++) {\r\n    const flag = flags[i]\r\n    let isSupported = false\r\n\r\n    for (let j=0; j < supportedFlags.length; j++) {\r\n      const supportedFlag = supportedFlags[j]\r\n\r\n      if (supportedFlag instanceof RegExp) {\r\n        if (supportedFlag.exec(flag)) {\r\n          isSupported = true\r\n          break\r\n        }\r\n      }\r\n      else if (supportedFlag === flag) {\r\n        isSupported = true\r\n        break\r\n      }\r\n    }\r\n\r\n    if (!isSupported) {\r\n      errorCallback(flag)\r\n    }\r\n  }\r\n}\r\n\r\nconst getFlagIntegerValue = function(flags, flag, defaultValue) {\r\n  let value = getFlagStringValue(flags, flag)\r\n\r\n  return value\r\n    ? parseInt(value, 10)\r\n    : (defaultValue && hasFlag(flags, flag))\r\n        ? defaultValue\r\n        : 0\r\n}\r\n\r\nconst getFlagStringValue = function(flags, flag) {\r\n  for (let i=0; i < flags.length; i++) {\r\n    if (flags[i].indexOf(flag + '=') === 0) {\r\n      return flags[i].substring((flag.length + 1))\r\n    }\r\n  }\r\n\r\n  return ''\r\n}\r\n\r\nconst hasFlag = function(flags, flag) {\r\n  return (flags.indexOf(flag) !== -1)\r\n}\r\n\r\nmodule.exports = {\r\n  isValid,\r\n  getFlagIntegerValue,\r\n  getFlagStringValue,\r\n  hasFlag\r\n}\r\n","const url_parse   = require('url').parse\r\nconst url_resolve = require('url').resolve\r\n\r\n// -----------------------------------------------------------------------------\r\n\r\nconst update_querystring = function(old_url, new_url, QSL, QSD, QSA) {\r\n  const old_query = parse_querystring(old_url, QSL)\r\n  const new_query = parse_querystring(new_url, QSL)\r\n\r\n  if (!old_query)\r\n    return new_url\r\n\r\n  if (!new_query) {\r\n    return QSD\r\n      ? new_url\r\n      : (new_url + '?' + old_query)\r\n  }\r\n  else {\r\n    return QSA\r\n      ? (new_url + '&' + old_query)\r\n      : new_url\r\n  }\r\n}\r\n\r\nconst parse_querystring = function(url, QSL) {\r\n  const index = QSL\r\n    ? url.lastIndexOf('?')\r\n    : url.indexOf('?')\r\n\r\n  const query = ((index >= 0) && (index < (url.length - 1)))\r\n    ? url.substring(index + 1)\r\n    : ''\r\n\r\n  return query\r\n}\r\n\r\n// -----------------------------------------------------------------------------\r\n\r\nlet parsed_url  = null\r\n\r\nconst parse_url = function(url) {\r\n  if (url && (!parsed_url || (parsed_url.href !== url))) {\r\n    const parts = url_parse(url)\r\n    if (!parts || !parts.protocol || !parts.hostname) return\r\n\r\n    parsed_url = parts\r\n  }\r\n}\r\n\r\nconst get_parsed_url = function() {\r\n  return parsed_url\r\n}\r\n\r\nconst get_parsed_pathname = function(should_trim_lead_slash, should_unescape) {\r\n  if (!parsed_url || !parsed_url.pathname) return ''\r\n\r\n  let pathname = parsed_url.pathname\r\n\r\n  if (should_trim_lead_slash)\r\n    pathname = trim_lead_slash(pathname)\r\n\r\n  if (should_unescape)\r\n    pathname = decodeURI(pathname)\r\n\r\n  return pathname\r\n}\r\n\r\nconst trim_lead_slash = function(pathname) {\r\n  return (pathname && (pathname[0] === '/'))\r\n    ? pathname.substring(1)\r\n    : pathname\r\n}\r\n\r\nconst get_resolved_url = function(relative_path) {\r\n  if (!relative_path)\r\n    relative_path = ''\r\n  if ((relative_path.substring(0,4).toLowerCase() !== 'http') && (!relative_path || (relative_path[0] !== '/')))\r\n    relative_path = '/' + relative_path\r\n\r\n  return parsed_url\r\n    ? url_resolve(parsed_url.href, relative_path)\r\n    : to\r\n}\r\n\r\nconst is_redirect_url = function(new_url) {\r\n  if (!parsed_url) return false\r\n\r\n  const parts = url_parse(new_url)\r\n  if (!parts || !parts.protocol || !parts.hostname) return false\r\n\r\n  return (parts.protocol !== parsed_url.protocol) || (parts.host !== parsed_url.host)\r\n}\r\n\r\n// -----------------------------------------------------------------------------\r\n\r\nconst format_backref_value = function(backref_value, flags) {\r\n  if (!backref_value || !flags)\r\n    return backref_value\r\n\r\n  if (!flags.B && !flags.BCTLS)\r\n    return backref_value\r\n\r\n  let whitelist = ''\r\n  let blacklist = flags.BNE || ''\r\n\r\n  if (flags.B) {\r\n    if (typeof flags.B === 'string') {\r\n      // user defined\r\n      whitelist = flags.B\r\n    } else {\r\n      // all characters outside ASCII ranges: 48-57, 65-90, 97-122\r\n      whitelist = '^0-9A-Za-z'\r\n    }\r\n  }\r\n  else {\r\n    // flags.BCTLS\r\n    // all characters inside ASCII range: 0-32,127\r\n    whitelist = '\\\\x00-\\\\x20\\\\x7f'\r\n  }\r\n\r\n  return escape_backref_value(backref_value, whitelist, blacklist, flags.BNP)\r\n}\r\n\r\nconst escape_backref_value = function(backref_value, whitelist, blacklist, BNP) {\r\n  const wl_regex = new RegExp(`[${whitelist}]`, 'g')\r\n  const bl_regex = new RegExp(`[${blacklist}]`)\r\n\r\n  return backref_value.replace(wl_regex, function(c) {\r\n    if (bl_regex.test(c))\r\n      return c\r\n\r\n    if ((c === ' ') && !BNP)\r\n      return '+'\r\n\r\n    return `%${c.charCodeAt(0).toString(16).toUpperCase()}`\r\n  })\r\n}\r\n\r\n// -----------------------------------------------------------------------------\r\n\r\nmodule.exports = {\r\n  update_querystring,\r\n  parse_querystring,\r\n  parse_url,\r\n  get_parsed_url,\r\n  get_parsed_pathname,\r\n  trim_lead_slash,\r\n  get_resolved_url,\r\n  is_redirect_url,\r\n  format_backref_value\r\n}\r\n","const url_parse = require('url').parse\r\nconst uh        = require('./url-helper')\r\n\r\nconst regexs = {\r\n  \"backref-rule-variable\":     /\\$([0-9])/g,\r\n  \"backref-cond-variable\":     /%([0-9])/g,\r\n\r\n  \"server-variable\":           /%{(API_VERSION|AUTH_TYPE|CONN_REMOTE_ADDR|CONN_REMOTE_ADDR|CONTEXT_DOCUMENT_ROOT|CONTEXT_PREFIX|DOCUMENT_ROOT|HTTPS|HTTP_ACCEPT|HTTP_COOKIE|HTTP_FORWARDED|HTTP_HOST|HTTP_PROXY_CONNECTION|HTTP_REFERER|HTTP_USER_AGENT|IPV6|IS_SUBREQ|PATH_INFO|QUERY_STRING|REMOTE_ADDR|REMOTE_ADDR|REMOTE_HOST|REMOTE_IDENT|REMOTE_PORT|REMOTE_USER|REQUEST_FILENAME|REQUEST_METHOD|REQUEST_SCHEME|REQUEST_URI|SCRIPT_FILENAME|SCRIPT_GROUP|SCRIPT_USER|SERVER_ADDR|SERVER_ADMIN|SERVER_NAME|SERVER_PORT|SERVER_PROTOCOL|SERVER_SOFTWARE|THE_REQUEST|TIME|TIME_DAY|TIME_HOUR|TIME_MIN|TIME_MON|TIME_SEC|TIME_WDAY|TIME_YEAR)}/g,\r\n  \"environment-variable\":      /%{ENV:([^}]+)}/g,\r\n  \"ssl-environment-variable\":  /%{SSL:(API_VERSION|AUTH_TYPE|DOCUMENT_ROOT|HTTPS|HTTP_ACCEPT|HTTP_COOKIE|HTTP_FORWARDED|HTTP_HOST|HTTP_PROXY_CONNECTION|HTTP_REFERER|HTTP_USER_AGENT|IS_SUBREQ|PATH_INFO|QUERY_STRING|REMOTE_ADDR|REMOTE_HOST|REMOTE_IDENT|REMOTE_USER|REQUEST_FILENAME|REQUEST_METHOD|REQUEST_SCHEME|REQUEST_URI|SERVER_ADMIN|SERVER_NAME|SERVER_PORT|SERVER_PROTOCOL|SERVER_SOFTWARE|SSL_CIPHER|SSL_CIPHER_ALGKEYSIZE|SSL_CIPHER_EXPORT|SSL_CIPHER_USEKEYSIZE|SSL_CLIENT_A_KEY|SSL_CLIENT_A_SIG|SSL_CLIENT_CERT|SSL_CLIENT_CERT_CHAIN_n|SSL_CLIENT_CERT_RFC4523_CEA|SSL_CLIENT_I_DN|SSL_CLIENT_I_DN_x509|SSL_CLIENT_M_SERIAL|SSL_CLIENT_M_VERSION|SSL_CLIENT_SAN_DNS_n|SSL_CLIENT_SAN_Email_n|SSL_CLIENT_SAN_OTHER_msUPN_n|SSL_CLIENT_S_DN|SSL_CLIENT_S_DN_x509|SSL_CLIENT_VERIFY|SSL_CLIENT_V_END|SSL_CLIENT_V_REMAIN|SSL_CLIENT_V_START|SSL_COMPRESS_METHOD|SSL_PROTOCOL|SSL_SECURE_RENEG|SSL_SERVER_A_KEY|SSL_SERVER_A_SIG|SSL_SERVER_CERT|SSL_SERVER_I_DN|SSL_SERVER_I_DN_x509|SSL_SERVER_M_SERIAL|SSL_SERVER_M_VERSION|SSL_SERVER_SAN_DNS_n|SSL_SERVER_SAN_Email_n|SSL_SERVER_SAN_OTHER_dnsSRV_n|SSL_SERVER_S_DN|SSL_SERVER_S_DN_x509|SSL_SERVER_V_END|SSL_SERVER_V_START|SSL_SESSION_ID|SSL_SESSION_RESUMED|SSL_SRP_USER|SSL_SRP_USERINFO|SSL_TLS_SNI|SSL_VERSION_INTERFACE|SSL_VERSION_LIBRARY|THE_REQUEST|TIME|TIME_DAY|TIME_HOUR|TIME_MIN|TIME_MON|TIME_SEC|TIME_WDAY|TIME_YEAR)}/g,\r\n  \"http-header-variable\":      /%{HTTP:([^}]+)}/g,\r\n\r\n  \"generic-variable\":          /%{[^}]*}/g\r\n}\r\n\r\nconst get_regex = function(key) {\r\n  const regex = regexs[key]\r\n\r\n  if (regex.global)\r\n    regex.lastIndex = 0\r\n\r\n  return regex\r\n}\r\n\r\nconst get_supportedVariables = function() {\r\n  return [\r\n    get_regex('server-variable'),\r\n    get_regex('environment-variable'),\r\n    get_regex('ssl-environment-variable'),\r\n    get_regex('http-header-variable')\r\n  ]\r\n}\r\n\r\nconst isValid = function (testString, errorCallback) {\r\n  if (!testString || (typeof errorCallback !== 'function')) return\r\n\r\n  const all_variables = []\r\n  let regex, matches\r\n\r\n  regex = get_regex('generic-variable')\r\n  while (matches = regex.exec(testString)) {\r\n    all_variables.push(matches[0])\r\n  }\r\n\r\n  if (all_variables.length) {\r\n    const supportedVariables = get_supportedVariables()\r\n\r\n    for (let i=0; i < all_variables.length; i++) {\r\n      const variable = all_variables[i]\r\n      let isSupported = false\r\n\r\n      for (let j=0; j < supportedVariables.length; j++) {\r\n        regex = supportedVariables[j]\r\n\r\n        if (regex.test(variable)) {\r\n          isSupported = true\r\n          break\r\n        }\r\n      }\r\n\r\n      if (!isSupported) {\r\n        errorCallback(variable)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst resolveVariables = function(testString, errorCallback, url, variables, currentRuleMatches, previousCondMatches, flags) {\r\n  if (!testString || (typeof errorCallback !== 'function')) return\r\n\r\n  if (!variables)\r\n    variables = {}\r\n\r\n  addUrlDerivedVariables(url, variables)\r\n\r\n  const variableKeys = ['backref-rule', 'backref-cond', 'server', 'environment', 'ssl-environment', 'http-header']\r\n  let resolvedTestString = testString\r\n  let variableKey, regex, matches, variableExpression, unresolvedVariable, resolvedVariable\r\n\r\n  for (let i=0; i < variableKeys.length; i++) {\r\n    variableKey = variableKeys[i]\r\n    regex       = get_regex(variableKey + '-variable')\r\n\r\n    while (matches = regex.exec(testString)) {\r\n      variableExpression = matches[0]\r\n      unresolvedVariable = matches[1]\r\n\r\n      try {\r\n        switch(variableKey) {\r\n          case 'backref-rule': {\r\n              const backref_index = parseInt(unresolvedVariable, 10)\r\n              resolvedVariable    = currentRuleMatches[backref_index]\r\n              resolvedVariable    = uh.format_backref_value(resolvedVariable, flags)\r\n            }\r\n            break\r\n          case 'backref-cond': {\r\n              const backref_index = parseInt(unresolvedVariable, 10)\r\n              resolvedVariable    = previousCondMatches[backref_index]\r\n              resolvedVariable    = uh.format_backref_value(resolvedVariable, flags)\r\n            }\r\n            break\r\n          default:\r\n            resolvedVariable = variables[variableKey][unresolvedVariable]\r\n            break\r\n        }\r\n\r\n        if (resolvedVariable === undefined) throw ''\r\n\r\n        resolvedTestString = resolvedTestString.replaceAll(variableExpression, resolvedVariable)\r\n      }\r\n      catch(e) {\r\n        errorCallback(variableExpression, variableKey)\r\n      }\r\n    }\r\n  }\r\n\r\n  return resolvedTestString\r\n}\r\n\r\nconst addUrlDerivedVariables = function(url, variables) {\r\n  if (!url) return\r\n\r\n  if (!variables['server'])\r\n    variables['server'] = {}\r\n\r\n  if (!variables['ssl-environment'])\r\n    variables['ssl-environment'] = {}\r\n\r\n  const parts = url_parse(url)\r\n\r\n  variables['server']['REQUEST_URI']  = parts.pathname\r\n  variables['server']['QUERY_STRING'] = parts.query\r\n  variables['server']['THE_REQUEST']  = url\r\n\r\n  variables['ssl-environment']['REQUEST_URI']  = parts.pathname\r\n  variables['ssl-environment']['QUERY_STRING'] = parts.query\r\n  variables['ssl-environment']['THE_REQUEST']  = url\r\n}\r\n\r\nmodule.exports = {\r\n  isValid,\r\n  resolveVariables\r\n}\r\n","const htaccess_tester = require('./htaccess-tester/tester')\r\n\r\nmodule.exports = htaccess_tester\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","window.htaccess_tester = require('../..')\r\n"],"names":["regexs","url","RegExp","host","URL","constructor","base","resolve","this","href","srcURL","dstURL","fields","i","length","field","replace","toString","protocol","username","password","pathname","search","hash","toJSON","matches","exec","Error","hostname","port","origin","URLSearchParams","searchParams","parse","parseQueryString","arguments","undefined","slashes","auth","path","query","substring","split","forEach","pair","index","indexOf","key","val","push","has","get","getAll","set","append","delete","splice","sort","sorted","keys","Object","values","entries","denormalized","callback","thisArg","_ref","apply","exclude_question_mark","_ref2","map_clone","module","exports","e","window","jsURL","RewriteRules","text","testString","condPattern","flags","map","Function","prototype","call","String","trim","filter","flag","pattern","substitution","conditions","HtaccessFile","require","RewriteRule","RewriteCond","Parser","content","Array","isArray","line","trimmed","parseContent","htaccessFile","RewriteEngineActivated","parts","part","stripQuotes","toLowerCase","RewriteBase","rule","s","test","slice","vi","fv","supportedFlags","baseCondition","assign","condPatternFlags","re","isNC","runTest","variables","currentRuleMatches","previousCondMatches","log","errors","isValid","is_valid","is_match","resolvedTestString","resolveVariables","variable","result","testVal","condVal","parseInt","isValidTestString","isValidFlags","hasFlag","isOR","fh","uh","baseRule","runAllTests","get_parsed_pathname","logs","doAllConditionsMatch","allConditionsMatch","new_url","resolvedSubstitutionString","variableKey","get_backref_format_flags","update_querystring","isQSL","isQSD","isQSA","all_conditions_match","getStatusCode","getRedirectStatusCode","getMimeType","getSkipCount","is_redirect","status_code","is_redirect_url","is_passthrough","isPassThrough","is_last","isLast","nextCount","getNextCount","runNext","trim_lead_slash","get_resolved_url","OK","count","iterations","get_resolved_filepath","isValidSubstitutionString","state","currentIsOr","prevWasOr","orConditionMet","getFlagIntegerValue","getFlagStringValue","getB","getBNE","isBCTLS","isBNP","htaccessParser","HtaccessTester","test_data","test_results","setRewriteBase","rules","processAllRules","success","error","message","htaccessContent","htaccess","parse_url","allLogs","finalResult","skip_count","someLogs","is_skipped","file_path","data","concat","rb","relative_path","errorCallback","isSupported","j","supportedFlag","defaultValue","value","url_parse","url_resolve","parse_querystring","QSL","lastIndexOf","parsed_url","escape_backref_value","backref_value","whitelist","blacklist","BNP","wl_regex","bl_regex","c","charCodeAt","toUpperCase","old_url","QSD","QSA","old_query","new_query","get_parsed_url","should_trim_lead_slash","should_unescape","decodeURI","to","format_backref_value","B","BCTLS","BNE","get_regex","regex","global","lastIndex","addUrlDerivedVariables","all_variables","supportedVariables","variableKeys","variableExpression","unresolvedVariable","resolvedVariable","replaceAll","htaccess_tester","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","id","loaded","__webpack_modules__","nmd","paths","children"],"sourceRoot":""}