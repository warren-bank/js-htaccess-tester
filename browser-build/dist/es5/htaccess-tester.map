{"version":3,"file":"htaccess-tester.js","mappings":"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","sources":["webpack://@warren-bank/htaccess-tester/./node_modules/@warren-bank/url/es6-node/jsURL.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-parser/model/HtaccessFile.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-parser/model/RewriteCond.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-parser/model/RewriteRule.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-parser/parser.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/model/RewriteCond.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/model/RewriteRule.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/tester.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/util/file-helper.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/util/flag-validator.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/util/url-helper.js","webpack://@warren-bank/htaccess-tester/../lib/htaccess-tester/util/variable-interpolator.js","webpack://@warren-bank/htaccess-tester/../lib/index.js","webpack://@warren-bank/htaccess-tester/webpack/bootstrap","webpack://@warren-bank/htaccess-tester/webpack/runtime/node module decorator","webpack://@warren-bank/htaccess-tester/./src/globals.js"],"sourcesContent":["const regexs = {\r\n  url:  new RegExp('^([^/:]+:)?(?://(?:([^/:@]+):?([^/:@]+)?@)?([^:/\\\\?#]+)(?::(\\\\d+))?)?(/[^\\\\?#]*|[^\\\\?#]+)?(\\\\?[^#]*)?(#.*)?$'),\r\n  host: /^([^:]+)(?::(\\d+))?$/\r\n}\r\n\r\nclass URL {\r\n  #_searchParams = ''\r\n\r\n  constructor(url, base) {\r\n    if (base)\r\n      url = URL.resolve(url, base) || ''\r\n\r\n    this.href = url\r\n  }\r\n\r\n  static resolve(url, base) {\r\n    const srcURL = new URL(base)\r\n    const dstURL = new URL(url)\r\n\r\n    const fields = ['protocol', 'username', 'password', 'hostname', 'port', 'pathname', 'search', 'hash']\r\n\r\n    // copy missing fields in order, and stop when the 1st populated field is encountered.\r\n    // when the 1st populated field is pathname, do the equivalent to: path.join(base_pathname, url_pathname)\r\n    for (let i=0; i < fields.length; i++) {\r\n      let field = fields[i]\r\n\r\n      if ((field === 'pathname') && dstURL[field] && srcURL[field] && (dstURL[field][0] !== '/'))\r\n        dstURL[field] = srcURL[field].replace(/[^\\/]*$/, '') + dstURL[field]\r\n      if (dstURL[field])\r\n        break\r\n      if (srcURL[field])\r\n        dstURL[field] = srcURL[field]\r\n    }\r\n\r\n    return dstURL.toString()\r\n  }\r\n\r\n  toString() {\r\n    return `${this.protocol}${this.host ? `//${this.username ? (this.password ? `${this.username}:${this.password}@` : `${this.username}@`) : ''}${this.host}` : ''}${this.pathname}${this.search}${this.hash}`\r\n  }\r\n\r\n  toJSON() {\r\n    return this.toString()\r\n  }\r\n\r\n  get href() {\r\n    return this.toString()\r\n  }\r\n\r\n  set href(url) {\r\n    const matches = regexs.url.exec(url)\r\n    if (!matches) throw new Error(\"Failed to construct 'URL': Invalid URL\")\r\n\r\n    this.protocol     = matches[1] || ''\r\n    this.username     = matches[2] || ''\r\n    this.password     = matches[3] || ''\r\n    this.hostname     = matches[4] || ''\r\n    this.port         = matches[5] || ''\r\n    this.pathname     = matches[6] || ''\r\n    this.search       = matches[7] || ''\r\n    this.hash         = matches[8] || ''\r\n  }\r\n\r\n  get host() {\r\n    return this.port ? `${this.hostname}:${this.port}` : this.hostname\r\n  }\r\n\r\n  set host(host) {\r\n    const matches = regexs.host.exec(host)\r\n    if (!matches) throw new Error(\"Failed to update 'URL': Invalid host\")\r\n\r\n    this.hostname     = matches[1] || ''\r\n    this.port         = matches[2] || ''\r\n  }\r\n\r\n  // read-only\r\n  get origin() {\r\n    return `${this.protocol}//${this.host}`\r\n  }\r\n\r\n  get search() {\r\n    return this.#_searchParams.toString()\r\n  }\r\n\r\n  set search(search) {\r\n    this.#_searchParams = new URLSearchParams(search)\r\n  }\r\n\r\n  // read-only\r\n  get searchParams() {\r\n    return this.#_searchParams\r\n  }\r\n\r\n  // ===================\r\n  // additional methods:\r\n  // ===================\r\n\r\n  parse(parseQueryString = false) {\r\n    return {\r\n      slashes:  true,\r\n      href:     this.href,\r\n      protocol: this.protocol,\r\n      username: this.username,\r\n      password: this.password,\r\n      auth:     `${this.username ? (this.password ? `${this.username}:${this.password}` : `${this.username}`) : ''}`,\r\n      hostname: this.hostname,\r\n      port:     this.port,\r\n      host:     this.host,\r\n      pathname: this.pathname,\r\n      search:   this.search,\r\n      path:     `${this.pathname}${this.search}`,\r\n      query:    (parseQueryString ? this.searchParams.parse() : this.searchParams.toString(/* exclude_question_mark= */ true)),\r\n      hash:     this.hash\r\n    }\r\n  }\r\n}\r\n\r\nclass URLSearchParams {\r\n  #_map    = {}\r\n  #_sorted = false\r\n\r\n  constructor(search) {\r\n    this.#_map = {}\r\n\r\n    if (search && (search[0] === '?'))\r\n      search = search.substring(1)\r\n\r\n    if (search) {\r\n      const pairs = search.split('&')\r\n      pairs.forEach(pair => {\r\n        const index = pair.indexOf('=')\r\n\r\n        if (index > 0) {\r\n          const key = pair.substring(0, index)\r\n          const val = (index + 1 < pair.length) ? pair.substring(index + 1) : ''\r\n\r\n          if (!this.#_map[key])\r\n            this.#_map[key] = []\r\n\r\n          this.#_map[key].push(val)\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  has(key) {\r\n    return !!this.#_map[key]\r\n  }\r\n\r\n  get(key) {\r\n    return this.#_map[key] ? this.#_map[key][0] : null\r\n  }\r\n\r\n  getAll(key) {\r\n    return this.#_map[key] ? [...this.#_map[key]] : []\r\n  }\r\n\r\n  set(key, val) {\r\n    this.#_map[key] = [val]\r\n  }\r\n\r\n  append(key, val) {\r\n    if (!this.#_map[key])\r\n      this.#_map[key] = []\r\n\r\n    this.#_map[key].push(val)\r\n  }\r\n\r\n  delete(key, val) {\r\n    if (!this.#_map[key]) return\r\n\r\n    if (val) {\r\n      const index = this.#_map[key].indexOf(val)\r\n      if (index >= 0) {\r\n        this.#_map[key].splice(index, 1)\r\n\r\n        if (!this.#_map[key].length)\r\n          delete this.#_map[key]\r\n      }\r\n    }\r\n    else {\r\n      delete this.#_map[key]\r\n    }\r\n  }\r\n\r\n  sort(sorted = true) {\r\n    this.#_sorted = !!sorted\r\n  }\r\n\r\n  keys() {\r\n    const keys = Object.keys(this.#_map)\r\n    if (this.#_sorted) keys.sort()\r\n    return keys\r\n  }\r\n\r\n  values() {\r\n    const values = []\r\n    for (const key in this.#_map) {\r\n      values.push(...this.#_map[key])\r\n    }\r\n    if (this.#_sorted) values.sort()\r\n    return values\r\n  }\r\n\r\n  entries() {\r\n    const denormalized = []\r\n    const keys = this.keys()\r\n    keys.forEach(key => {\r\n      const vals = this.#_sorted\r\n        ? [...this.#_map[key]].sort()\r\n        : this.#_map[key]\r\n      vals.forEach(val => {\r\n        denormalized.push([key, val])\r\n      })\r\n    })\r\n    return denormalized\r\n  }\r\n\r\n  forEach(callback, thisArg) {\r\n    const denormalized = this.entries()\r\n    denormalized.forEach(([key, val]) => {\r\n      callback.apply(thisArg, [val, key, this])\r\n    })\r\n  }\r\n\r\n  toString(exclude_question_mark = false) {\r\n    let search = ''\r\n    const denormalized = this.entries()\r\n    denormalized.forEach(([key, val]) => {\r\n      let prefix = search ? '&' : exclude_question_mark ? '' : '?'\r\n      search += `${prefix}${key}=${val}`\r\n    })\r\n    return search\r\n  }\r\n\r\n  toJSON() {\r\n    return this.toString()\r\n  }\r\n\r\n  // ===================\r\n  // additional methods:\r\n  // ===================\r\n\r\n  parse() {\r\n    const map_clone = {}\r\n    for (const key in this.#_map) {\r\n      map_clone[key] = [...this.#_map[key]]\r\n    }\r\n    return map_clone\r\n  }\r\n}\r\n\r\nconst parse = (url, parseQueryString = false) => {\r\n  return (new URL(url)).parse(parseQueryString)\r\n}\r\n\r\nconst resolve = (base, url) => URL.resolve(url, base)\r\n\r\ntry {\r\n  if (module instanceof Object)\r\n    module.exports = {URL, URLSearchParams, parse, resolve}\r\n}\r\ncatch(e) {}\r\n\r\ntry {\r\n  if (window instanceof Object)\r\n    window.jsURL = {URL, URLSearchParams, parse, resolve}\r\n}\r\ncatch(e) {}\r\n","function HtaccessFile() {\r\n  this.RewriteRules = []\r\n}\r\n\r\nmodule.exports = HtaccessFile\r\n","function RewriteCond(text, testString, condPattern, flags) {\r\n  this.text        = text\r\n  this.testString  = testString\r\n  this.condPattern = condPattern\r\n  this.flags       = flags.replace('[', '').replace(']', '').split(',')\r\n    .map(Function.prototype.call, String.prototype.trim)\r\n    .filter(function (flag) {\r\n      return (flag.length > 0)\r\n    })\r\n}\r\n\r\nmodule.exports = RewriteCond\r\n","function RewriteRule(text, pattern, substitution, flags, conditions) {\r\n  this.text         = text\r\n  this.pattern      = pattern\r\n  this.substitution = substitution\r\n  this.flags        = flags.replace('[', '').replace(']', '').split(',')\r\n    .map(Function.prototype.call, String.prototype.trim)\r\n    .filter(function (flag) {\r\n      return (flag.length > 0)\r\n    })\r\n  this.conditions   = conditions || []\r\n}\r\n\r\nmodule.exports = RewriteRule\r\n","const HtaccessFile = require('./model/HtaccessFile')\r\nconst RewriteRule = require('./model/RewriteRule')\r\nconst RewriteCond = require('./model/RewriteCond')\r\n\r\nfunction Parser(content) {\r\n  if (!Array.isArray(content)) {\r\n    content = content.toString().split('\\n')\r\n  }\r\n\r\n  this.content = content.filter(function (line) {\r\n    const trimmed = line.trim()\r\n    return (trimmed.length > 0) && (trimmed.substring(0, 1) !== '#')\r\n  })\r\n\r\n  return this.parseContent()\r\n}\r\n\r\nParser.prototype.parseContent = function () {\r\n  const htaccessFile = new HtaccessFile()\r\n\r\n  let RewriteEngineActivated = false\r\n  let conditions = []\r\n  let flags = null\r\n\r\n  for (let i=0; i < this.content.length; i++) {\r\n    const line = this.content[i].trim()\r\n    const parts = line.trim().split(' ').filter(function (part) {\r\n      return part.length > 0\r\n    })\r\n\r\n    const directive = parts[0]\r\n\r\n    switch(directive) {\r\n      case 'RewriteEngine':\r\n        RewriteEngineActivated = (this.stripQuotes(parts[1]).toLowerCase() === 'on')\r\n        break\r\n\r\n      case 'RewriteBase':\r\n        if (RewriteEngineActivated) {\r\n          htaccessFile.RewriteBase = this.stripQuotes(parts[1])\r\n        }\r\n        break\r\n\r\n      case 'RewriteCond':\r\n        if (RewriteEngineActivated) {\r\n          flags = (typeof parts[3] === 'undefined' ? '' : parts[3])\r\n          conditions.push(new RewriteCond(line, this.stripQuotes(parts[1]), this.stripQuotes(parts[2]), flags))\r\n        }\r\n        break\r\n\r\n      case 'RewriteRule':\r\n        if (RewriteEngineActivated) {\r\n          flags = (typeof parts[3] === 'undefined' ? '' : parts[3])\r\n          const rule = new RewriteRule(line, this.stripQuotes(parts[1]), this.stripQuotes(parts[2]), flags, conditions)\r\n\r\n          htaccessFile.RewriteRules.push(rule)\r\n          conditions = []\r\n        }\r\n        break\r\n    }\r\n  }\r\n\r\n  return htaccessFile\r\n}\r\n\r\nParser.prototype.stripQuotes = function (s) {\r\n  return (/^\"([^\"]*)\"$/.test(s) || /^'([^']*)'$/.test(s))\r\n    ? s.slice(1, -1)\r\n    : s\r\n}\r\n\r\nmodule.exports = function (content) {\r\n  return (new Parser(content))\r\n}\r\n","// references:\r\n//   https://httpd.apache.org/docs/2.4/mod/mod_rewrite.html#rewritecond\r\n\r\nconst vi = require('../util/variable-interpolator')\r\nconst fv = require('../util/flag-validator')\r\n\r\nconst regexs = {\r\n  \"lexicographical-operation\": /^(<|>|=|<=|>=)(.*)$/,\r\n  \"integer-operation\":         /^(-eq|-ge|-gt|-le|-lt|-ne)(.*)$/\r\n}\r\n\r\nconst supportedFlags = [\r\n  'NC', 'nocase',\r\n  'OR', 'ornext'\r\n]\r\n\r\nfunction RewriteCond(baseCondition) {\r\n  Object.assign(this, baseCondition)\r\n\r\n  this.condPatternFlags = {\r\n    \"negate\": false,\r\n    \"lexicographical-operation\": null,\r\n    \"integer-operation\": null\r\n  }\r\n\r\n  if (this.condPattern && (this.condPattern[0] === '!')) {\r\n    this.condPatternFlags['negate'] = true\r\n    this.condPattern = this.condPattern.substring(1)\r\n  }\r\n\r\n  if (this.condPattern) {\r\n    const matches = regexs[\"lexicographical-operation\"].exec(this.condPattern)\r\n\r\n    if (matches) {\r\n      this.condPatternFlags['lexicographical-operation'] = matches[1]\r\n      this.condPattern = matches[2]\r\n    }\r\n  }\r\n\r\n  if (this.condPattern && !this.condPatternFlags['lexicographical-operation']) {\r\n    const matches = regexs[\"integer-operation\"].exec(this.condPattern)\r\n\r\n    if (matches) {\r\n      this.condPatternFlags['integer-operation'] = matches[1]\r\n      this.condPattern = matches[2]\r\n    }\r\n  }\r\n\r\n  if (this.condPattern && !this.condPatternFlags['lexicographical-operation'] && !this.condPatternFlags['integer-operation']) {\r\n    this.re = this.isNC()\r\n      ? new RegExp(this.condPattern, 'i')\r\n      : new RegExp(this.condPattern)\r\n  }\r\n}\r\n\r\nRewriteCond.prototype.runTest = function (url, variables, currentRuleMatches, previousCondMatches) {\r\n  const log = {\r\n    \"text\":         this.text,\r\n    \"is_condition\": true\r\n  }\r\n\r\n  log.errors = this.isValid()\r\n\r\n  if (log.errors && log.errors.length) {\r\n    log.is_valid = false\r\n    log.is_match = false\r\n    return log\r\n  }\r\n\r\n  const resolvedTestString = vi.resolveVariables(\r\n    this.testString,\r\n    function(variable) {\r\n      log.errors.push('RewriteCond TestString variable not resolved: ' + variable)\r\n    },\r\n    url, variables, currentRuleMatches, previousCondMatches\r\n  )\r\n\r\n  if (log.errors && log.errors.length) {\r\n    log.is_valid = false\r\n    log.is_match = false\r\n    return log\r\n  }\r\n\r\n  log.is_valid = true\r\n  log.result = {\r\n    \"TestString\":       resolvedTestString,\r\n    \"CondPatternFlags\": Object.assign({}, this.condPatternFlags)\r\n  }\r\n\r\n  if (this.condPatternFlags['lexicographical-operation']) {\r\n    const testVal = resolvedTestString\r\n    const condVal = this.condPattern\r\n\r\n    switch(this.condPatternFlags['lexicographical-operation']) {\r\n      case '<':\r\n        log.is_match = (testVal < condVal)\r\n        break\r\n      case '>':\r\n        log.is_match = (testVal > condVal)\r\n        break\r\n      case '=':\r\n        log.is_match = (testVal == condVal)\r\n        break\r\n      case '<=':\r\n        log.is_match = (testVal <= condVal)\r\n        break\r\n      case '>=':\r\n        log.is_match = (testVal >= condVal)\r\n        break\r\n      default:\r\n        log.is_match = false\r\n    }\r\n  }\r\n\r\n  else if (this.condPatternFlags['integer-operation']) {\r\n    const testVal = parseInt(resolvedTestString, 10)\r\n    const condVal = parseInt(this.condPattern,   10)\r\n\r\n    switch(this.condPatternFlags['integer-operation']) {\r\n      case '-eq':\r\n        log.is_match = (testVal == condVal)\r\n        break\r\n      case '-ge':\r\n        log.is_match = (testVal >= condVal)\r\n        break\r\n      case '-gt':\r\n        log.is_match = (testVal > condVal)\r\n        break\r\n      case '-le':\r\n        log.is_match = (testVal <= condVal)\r\n        break\r\n      case '-lt':\r\n        log.is_match = (testVal < condVal)\r\n        break\r\n      case '-ne':\r\n        log.is_match = (testVal != condVal)\r\n        break\r\n      default:\r\n        log.is_match = false\r\n    }\r\n  }\r\n\r\n  else {\r\n    matches = this.re.exec(resolvedTestString)\r\n\r\n    log.is_match = !!matches\r\n\r\n    if (matches)\r\n      log.result.matches = matches.slice()\r\n  }\r\n\r\n  if (this.condPatternFlags['negate'])\r\n    log.is_match = !log.is_match\r\n\r\n  return log\r\n}\r\n\r\nRewriteCond.prototype.isValid = function () {\r\n  const errors = []\r\n\r\n  this.isValidTestString(errors)\r\n  this.isValidFlags(errors)\r\n\r\n  return errors\r\n}\r\n\r\nRewriteCond.prototype.isValidTestString = function (errors) {\r\n  // special case\r\n  if (this.testString === 'expr') {\r\n    errors.push('RewriteCond TestString not supported: ' + this.testString)\r\n    return\r\n  }\r\n\r\n  vi.isValid(\r\n    this.testString,\r\n    function(variable) {\r\n      errors.push('RewriteCond TestString variable not supported: ' + variable)\r\n    }\r\n  )\r\n}\r\n\r\nRewriteCond.prototype.isValidFlags = function (errors) {\r\n  fv.isValid(\r\n    this.flags,\r\n    supportedFlags,\r\n    function(flag) {\r\n      errors.push('RewriteCond flag not supported: ' + flag)\r\n    }\r\n  )\r\n}\r\n\r\nRewriteCond.prototype.isNC = function () {\r\n  return fv.hasFlag(this.flags, 'NC')\r\n    ||   fv.hasFlag(this.flags, 'nocase')\r\n}\r\n\r\nRewriteCond.prototype.isOR = function () {\r\n  return fv.hasFlag(this.flags, 'OR')\r\n    ||   fv.hasFlag(this.flags, 'ornext')\r\n}\r\n\r\nmodule.exports = RewriteCond\r\n","// references:\r\n//   https://httpd.apache.org/docs/2.4/mod/mod_rewrite.html#rewriterule\r\n\r\nconst RewriteCond = require('./RewriteCond')\r\nconst vi          = require('../util/variable-interpolator')\r\nconst fv          = require('../util/flag-validator')\r\nconst fh          = require('../util/file-helper')\r\nconst uh          = require('../util/url-helper')\r\n\r\nconst supportedFlags = [\r\n  'B', /^B=(.+)$/,\r\n  'BCTLS',\r\n  /^BNE=(.+)$/,\r\n  'BNP', 'backrefnoplus',\r\n  'END',\r\n  'F', 'forbidden',\r\n  'G', 'gone',\r\n  'L', 'last',\r\n  'N', /^N=(\\d+)$/, 'next', /^next=(\\d+)$/,\r\n  'NC', 'nocase',\r\n  'PT', 'passthrough',\r\n  'QSA', 'qsappend',\r\n  'QSD', 'qsdiscard',\r\n  'QSL', 'qslast',\r\n  'R', /^R=(\\d{3})$/, 'redirect', /^redirect=(\\d{3})$/,\r\n  'S', /^S=(\\d+)$/, 'skip', /^skip=(\\d+)$/,\r\n  /^T=(.+)$/, /^type=(.+)$/\r\n]\r\n\r\nfunction RewriteRule(baseRule) {\r\n  Object.assign(this, baseRule)\r\n\r\n  for (let i=0; i < this.conditions.length; i++) {\r\n    this.conditions[i] = new RewriteCond(this.conditions[i])\r\n  }\r\n\r\n  this.re = this.isNC()\r\n    ? new RegExp(this.pattern, 'i')\r\n    : new RegExp(this.pattern)\r\n}\r\n\r\nRewriteRule.prototype.runAllTests = function (url, variables) {\r\n  const currentRuleMatches = this.re.exec(uh.get_parsed_pathname(true, true))\r\n  let previousCondMatches  = null\r\n  const logs = []\r\n\r\n  for (let i=0; i < this.conditions.length; i++) {\r\n    const log = this.conditions[i].runTest(url, variables, currentRuleMatches, previousCondMatches)\r\n\r\n    previousCondMatches = (log.result && log.result.matches)\r\n      ? log.result.matches\r\n      : null\r\n\r\n    logs.push(log)\r\n  }\r\n\r\n  logs.push(\r\n    this.runTest(url, variables, currentRuleMatches, previousCondMatches, this.doAllConditionsMatch(logs))\r\n  )\r\n\r\n  return logs\r\n}\r\n\r\nRewriteRule.prototype.runTest = function (url, variables, currentRuleMatches, previousCondMatches, allConditionsMatch) {\r\n  const log = {\r\n    \"text\":         this.text,\r\n    \"is_condition\": false\r\n  }\r\n\r\n  log.errors = this.isValid()\r\n\r\n  if (log.errors && log.errors.length) {\r\n    log.is_valid = false\r\n    log.is_match = false\r\n    return log\r\n  }\r\n\r\n  let new_url\r\n  if (this.substitution === '-') {\r\n    new_url = url\r\n  }\r\n  else {\r\n    const resolvedSubstitutionString = vi.resolveVariables(\r\n      this.substitution,\r\n      function(variable, variableKey) {\r\n        if ((variableKey === 'backref-rule') && !currentRuleMatches) return\r\n\r\n        log.errors.push('RewriteRule Substitution variable not resolved: ' + variable)\r\n      },\r\n      url, variables, currentRuleMatches, previousCondMatches,\r\n      this.get_backref_format_flags()\r\n    )\r\n\r\n    new_url = uh.update_querystring(\r\n      url, resolvedSubstitutionString,\r\n      this.isQSL(), this.isQSD(), this.isQSA()\r\n    )\r\n  }\r\n\r\n  if (log.errors && log.errors.length) {\r\n    log.is_valid = false\r\n    log.is_match = false\r\n    return log\r\n  }\r\n\r\n  log.is_valid = true\r\n  log.is_match = !!currentRuleMatches\r\n  log.all_conditions_match = allConditionsMatch\r\n  log.result = {\r\n    \"url\":         new_url,\r\n    \"status_code\": (this.getStatusCode() || this.getRedirectStatusCode() || null),\r\n    \"mime_type\":   this.getMimeType(),\r\n    \"skip_count\":  this.getSkipCount()\r\n  }\r\n\r\n  if (currentRuleMatches)\r\n    log.result.matches = currentRuleMatches.slice()\r\n\r\n  log.is_redirect = (\r\n       log.result.status_code\r\n   && (log.result.status_code >= 300)\r\n   && (log.result.status_code <  400)\r\n  )\r\n\r\n  if (!log.is_redirect && uh.is_redirect_url(new_url)) {\r\n    log.is_redirect        = true\r\n    log.result.status_code = 302\r\n  }\r\n\r\n  log.is_passthrough = this.isPassThrough()\r\n  log.is_last        = this.isLast()\r\n\r\n  let nextCount = (!log.is_valid || !log.is_match || (this.substitution === '-'))\r\n    ? 0\r\n    : this.getNextCount()\r\n\r\n  while ((nextCount > 0) && this.runNext(log, variables, previousCondMatches)) {\r\n    nextCount--\r\n  }\r\n\r\n  return log\r\n}\r\n\r\nRewriteRule.prototype.runNext = function (log, variables, previousCondMatches) {\r\n  const currentRuleMatches = this.re.exec(uh.trim_lead_slash(log.result.url))\r\n  if (!currentRuleMatches) return false\r\n\r\n  const url = uh.get_resolved_url(log.result.url)\r\n  let OK = true\r\n\r\n  const resolvedSubstitutionString = vi.resolveVariables(\r\n    this.substitution,\r\n    function(variable) {\r\n      OK = false\r\n    },\r\n    url, variables, currentRuleMatches, previousCondMatches,\r\n    this.get_backref_format_flags()\r\n  )\r\n\r\n  const new_url = uh.update_querystring(\r\n    url, resolvedSubstitutionString,\r\n    this.isQSL(), this.isQSD(), this.isQSA()\r\n  )\r\n\r\n  if (OK) {\r\n    if (!log.result['next'])\r\n      log.result['next'] = {\"count\": 0, \"iterations\": []}\r\n\r\n    log.result['next'].count++\r\n    log.result['next'].iterations.push({\r\n      \"url\":       url,\r\n      \"file_path\": fh.get_resolved_filepath(log.result.url),\r\n      \"matches\":   log.result.matches\r\n    })\r\n\r\n    log.result.url     = new_url\r\n    log.result.matches = currentRuleMatches.slice()\r\n  }\r\n\r\n  return OK\r\n}\r\n\r\nRewriteRule.prototype.isValid = function () {\r\n  const errors = []\r\n\r\n  this.isValidSubstitutionString(errors)\r\n  this.isValidFlags(errors)\r\n\r\n  return errors\r\n}\r\n\r\nRewriteRule.prototype.isValidSubstitutionString = function (errors) {\r\n  vi.isValid(\r\n    this.substitution,\r\n    function(variable) {\r\n      errors.push('RewriteRule Substitution variable not supported: ' + variable)\r\n    }\r\n  )\r\n}\r\n\r\nRewriteRule.prototype.isValidFlags = function (errors) {\r\n  fv.isValid(\r\n    this.flags,\r\n    supportedFlags,\r\n    function(flag) {\r\n      errors.push('RewriteRule flag not supported: ' + flag)\r\n    }\r\n  )\r\n}\r\n\r\nRewriteRule.prototype.doAllConditionsMatch = function (logs) {\r\n  const state = {\r\n    currentIsOr:    false,\r\n    prevWasOr:      false,\r\n    orConditionMet: false\r\n  }\r\n\r\n  for (let i=0; i < this.conditions.length; i++) {\r\n    state.currentIsOr = this.conditions[i].isOR()\r\n\r\n    // one of the OR condition has been met\r\n    if (state.prevWasOr && state.orConditionMet) {\r\n      state.prevWasOr      = state.currentIsOr\r\n      state.orConditionMet = state.currentIsOr\r\n      continue\r\n    }\r\n\r\n    // condition isn't met\r\n    if (!logs[i].is_match) {\r\n      if (state.currentIsOr) {\r\n        continue\r\n      }\r\n      else {\r\n        return false\r\n      }\r\n    }\r\n    else if (state.currentIsOr) {\r\n      state.orConditionMet = true\r\n      state.prevWasOr      = state.currentIsOr\r\n    }\r\n  }\r\n\r\n  return true\r\n}\r\n\r\nRewriteRule.prototype.getStatusCode = function () {\r\n  if (\r\n         (this.flags.indexOf('F')         !== -1)\r\n    ||   (this.flags.indexOf('forbidden') !== -1)\r\n  )\r\n    return 403\r\n\r\n  if (\r\n         (this.flags.indexOf('G')    !== -1)\r\n    ||   (this.flags.indexOf('gone') !== -1)\r\n  )\r\n    return 410\r\n\r\n  return 0\r\n}\r\n\r\nRewriteRule.prototype.getRedirectStatusCode = function () {\r\n  return fv.getFlagIntegerValue(this.flags, 'R',        302)\r\n    ||   fv.getFlagIntegerValue(this.flags, 'redirect', 302)\r\n}\r\n\r\nRewriteRule.prototype.getSkipCount = function () {\r\n  return fv.getFlagIntegerValue(this.flags, 'S',    0)\r\n    ||   fv.getFlagIntegerValue(this.flags, 'skip', 0)\r\n}\r\n\r\nRewriteRule.prototype.getNextCount = function () {\r\n  return fv.getFlagIntegerValue(this.flags, 'N',    10000)\r\n    ||   fv.getFlagIntegerValue(this.flags, 'next', 10000)\r\n}\r\n\r\nRewriteRule.prototype.getMimeType = function () {\r\n  return fv.getFlagStringValue(this.flags, 'T')\r\n    ||   fv.getFlagStringValue(this.flags, 'type')\r\n}\r\n\r\nRewriteRule.prototype.getB = function () {\r\n  return fv.getFlagStringValue(this.flags, 'B')\r\n    ||   fv.hasFlag(this.flags, 'B')\r\n}\r\n\r\nRewriteRule.prototype.getBNE = function () {\r\n  return fv.getFlagStringValue(this.flags, 'BNE')\r\n}\r\n\r\nRewriteRule.prototype.isBCTLS = function () {\r\n  return fv.hasFlag(this.flags, 'BCTLS')\r\n}\r\n\r\nRewriteRule.prototype.isBNP = function () {\r\n  return fv.hasFlag(this.flags, 'BNP')\r\n    ||   fv.hasFlag(this.flags, 'backrefnoplus')\r\n}\r\n\r\nRewriteRule.prototype.isNC = function () {\r\n  return fv.hasFlag(this.flags, 'NC')\r\n    ||   fv.hasFlag(this.flags, 'nocase')\r\n}\r\n\r\nRewriteRule.prototype.isQSA = function () {\r\n  return fv.hasFlag(this.flags, 'QSA')\r\n    ||   fv.hasFlag(this.flags, 'qsappend')\r\n}\r\n\r\nRewriteRule.prototype.isQSD = function () {\r\n  return fv.hasFlag(this.flags, 'QSD')\r\n    ||   fv.hasFlag(this.flags, 'qsdiscard')\r\n}\r\n\r\nRewriteRule.prototype.isQSL = function () {\r\n  return fv.hasFlag(this.flags, 'QSL')\r\n    ||   fv.hasFlag(this.flags, 'qslast')\r\n}\r\n\r\nRewriteRule.prototype.isPassThrough = function () {\r\n  return fv.hasFlag(this.flags, 'PT')\r\n    ||   fv.hasFlag(this.flags, 'passthrough')\r\n}\r\n\r\nRewriteRule.prototype.isLast = function () {\r\n  return fv.hasFlag(this.flags, 'L')\r\n    ||   fv.hasFlag(this.flags, 'last')\r\n    ||   fv.hasFlag(this.flags, 'END')\r\n}\r\n\r\nRewriteRule.prototype.get_backref_format_flags = function () {\r\n  return {\r\n    \"B\":     this.getB(),\r\n    \"BNE\":   this.getBNE(),\r\n    \"BCTLS\": this.isBCTLS(),\r\n    \"BNP\":   this.isBNP()\r\n  }\r\n}\r\n\r\nmodule.exports = RewriteRule\r\n","const RewriteRule    = require('./model/RewriteRule')\r\nconst fh             = require('./util/file-helper')\r\nconst uh             = require('./util/url-helper')\r\nconst htaccessParser = require('../htaccess-parser/parser')\r\n\r\nfunction HtaccessTester(test_data) {\r\n  this.test_data = test_data\r\n\r\n  return this.runTest()\r\n}\r\n\r\nHtaccessTester.prototype.runTest = function () {\r\n  this.test_results = {}\r\n\r\n  try {\r\n    this.parseContent()\r\n\r\n    fh.setRewriteBase(\r\n      this.htaccessFile.RewriteBase\r\n    )\r\n\r\n    this.rules = []\r\n    for (let i=0; i < this.htaccessFile.RewriteRules.length; i++) {\r\n      const rule = new RewriteRule(\r\n        this.htaccessFile.RewriteRules[i]\r\n      )\r\n \r\n     this.rules.push(rule)\r\n    }\r\n\r\n    const {result, log} = this.processAllRules(\r\n      this.test_data.url,\r\n      this.test_data.variables\r\n    )\r\n\r\n    this.test_results.success = true\r\n    this.test_results.result  = result\r\n    this.test_results.log     = log\r\n  }\r\n  catch(e) {\r\n    this.test_results.success = false\r\n    this.test_results.error   = e.message\r\n  }\r\n\r\n  return this.test_results\r\n}\r\n\r\nHtaccessTester.prototype.parseContent = function () {\r\n  let htaccessContent = this.test_data.htaccess\r\n\r\n  this.htaccessFile = htaccessParser(htaccessContent)\r\n}\r\n\r\nHtaccessTester.prototype.processAllRules = function (url, variables) {\r\n  uh.parse_url(url)\r\n\r\n  const allLogs   = []\r\n  let finalResult = null\r\n  let skip_count  = 0\r\n\r\n  for (let i=0; i < this.rules.length; i++) {\r\n    const rule     = this.rules[i]\r\n    const someLogs = rule.runAllTests(url, variables)\r\n\r\n    if (!someLogs || !someLogs.length) continue\r\n    allLogs.push(someLogs)\r\n\r\n    const log = someLogs[someLogs.length - 1]\r\n\r\n    if (skip_count > 0) {\r\n      log.is_skipped = true\r\n      skip_count--\r\n      continue\r\n    }\r\n\r\n    if (!log.is_valid || !log.is_match) continue\r\n\r\n    if (log.result)\r\n      finalResult = log.result\r\n\r\n    if (log.result && log.result.skip_count)\r\n      skip_count += log.result.skip_count\r\n\r\n    if (log.result && log.result.url) {\r\n      log.result.file_path = fh.get_resolved_filepath(log.result.url)\r\n      log.result.url       = uh.get_resolved_url(log.result.url)\r\n      url = log.result.url\r\n\r\n      if (log.is_passthrough) {\r\n        const data = this.processAllRules(url, variables)\r\n\r\n        log['passthrough'] = data.log\r\n        finalResult = data.result || finalResult\r\n        break\r\n      }\r\n    }\r\n\r\n    if (log.result && log.result.status_code && !log.is_redirect) break\r\n\r\n    if (log.is_last) break\r\n  }\r\n\r\n  return {\r\n    \"result\": finalResult,\r\n    \"log\":    Array.prototype.concat.apply([], allLogs)\r\n  }\r\n}\r\n\r\nmodule.exports = function (test_data) {\r\n  return (new HtaccessTester(test_data))\r\n}\r\n","let RewriteBase = '/'\r\n\r\nconst setRewriteBase = function(rb) {\r\n  RewriteBase = rb || '/'\r\n}\r\n\r\nconst get_resolved_filepath = function(relative_path) {\r\n  if (!relative_path)\r\n    relative_path = ''\r\n  if (relative_path.substring(0,4).toLowerCase() === 'http')\r\n    return null\r\n\r\n  return (RewriteBase && (relative_path.indexOf(RewriteBase) !== 0))\r\n    ? (RewriteBase + '/' + relative_path).replace(/[\\/]{2,}/g, '/')\r\n    : relative_path\r\n}\r\n\r\nmodule.exports = {\r\n  setRewriteBase,\r\n  get_resolved_filepath\r\n}\r\n","const isValid = function (flags, supportedFlags, errorCallback) {\r\n  if (!Array.isArray(supportedFlags) || !supportedFlags.length || (typeof errorCallback !== 'function')) return\r\n\r\n  for (let i=0; i < flags.length; i++) {\r\n    const flag = flags[i]\r\n    let isSupported = false\r\n\r\n    for (let j=0; j < supportedFlags.length; j++) {\r\n      const supportedFlag = supportedFlags[j]\r\n\r\n      if (supportedFlag instanceof RegExp) {\r\n        if (supportedFlag.exec(flag)) {\r\n          isSupported = true\r\n          break\r\n        }\r\n      }\r\n      else if (supportedFlag === flag) {\r\n        isSupported = true\r\n        break\r\n      }\r\n    }\r\n\r\n    if (!isSupported) {\r\n      errorCallback(flag)\r\n    }\r\n  }\r\n}\r\n\r\nconst getFlagIntegerValue = function(flags, flag, defaultValue) {\r\n  let value = getFlagStringValue(flags, flag)\r\n\r\n  return value\r\n    ? parseInt(value, 10)\r\n    : (defaultValue && hasFlag(flags, flag))\r\n        ? defaultValue\r\n        : 0\r\n}\r\n\r\nconst getFlagStringValue = function(flags, flag) {\r\n  for (let i=0; i < flags.length; i++) {\r\n    if (flags[i].indexOf(flag + '=') === 0) {\r\n      return flags[i].substring((flag.length + 1))\r\n    }\r\n  }\r\n\r\n  return ''\r\n}\r\n\r\nconst hasFlag = function(flags, flag) {\r\n  return (flags.indexOf(flag) !== -1)\r\n}\r\n\r\nmodule.exports = {\r\n  isValid,\r\n  getFlagIntegerValue,\r\n  getFlagStringValue,\r\n  hasFlag\r\n}\r\n","const url_parse   = require('url').parse\r\nconst url_resolve = require('url').resolve\r\n\r\n// -----------------------------------------------------------------------------\r\n\r\nconst update_querystring = function(old_url, new_url, QSL, QSD, QSA) {\r\n  const old_query = parse_querystring(old_url, QSL)\r\n  const new_query = parse_querystring(new_url, QSL)\r\n\r\n  if (!old_query)\r\n    return new_url\r\n\r\n  if (!new_query) {\r\n    return QSD\r\n      ? new_url\r\n      : (new_url + '?' + old_query)\r\n  }\r\n  else {\r\n    return QSA\r\n      ? (new_url + '&' + old_query)\r\n      : new_url\r\n  }\r\n}\r\n\r\nconst parse_querystring = function(url, QSL) {\r\n  const index = QSL\r\n    ? url.lastIndexOf('?')\r\n    : url.indexOf('?')\r\n\r\n  const query = ((index >= 0) && (index < (url.length - 1)))\r\n    ? url.substring(index + 1)\r\n    : ''\r\n\r\n  return query\r\n}\r\n\r\n// -----------------------------------------------------------------------------\r\n\r\nlet parsed_url  = null\r\n\r\nconst parse_url = function(url) {\r\n  if (url && (!parsed_url || (parsed_url.href !== url))) {\r\n    const parts = url_parse(url)\r\n    if (!parts || !parts.protocol || !parts.hostname) return\r\n\r\n    parsed_url = parts\r\n  }\r\n}\r\n\r\nconst get_parsed_url = function() {\r\n  return parsed_url\r\n}\r\n\r\nconst get_parsed_pathname = function(should_trim_lead_slash, should_unescape) {\r\n  if (!parsed_url || !parsed_url.pathname) return ''\r\n\r\n  let pathname = parsed_url.pathname\r\n\r\n  if (should_trim_lead_slash)\r\n    pathname = trim_lead_slash(pathname)\r\n\r\n  if (should_unescape)\r\n    pathname = decodeURI(pathname)\r\n\r\n  return pathname\r\n}\r\n\r\nconst trim_lead_slash = function(pathname) {\r\n  return (pathname && (pathname[0] === '/'))\r\n    ? pathname.substring(1)\r\n    : pathname\r\n}\r\n\r\nconst get_resolved_url = function(relative_path) {\r\n  if (!relative_path)\r\n    relative_path = ''\r\n  if ((relative_path.substring(0,4).toLowerCase() !== 'http') && (!relative_path || (relative_path[0] !== '/')))\r\n    relative_path = '/' + relative_path\r\n\r\n  return parsed_url\r\n    ? url_resolve(parsed_url.href, relative_path)\r\n    : to\r\n}\r\n\r\nconst is_redirect_url = function(new_url) {\r\n  if (!parsed_url) return false\r\n\r\n  const parts = url_parse(new_url)\r\n  if (!parts || !parts.protocol || !parts.hostname) return false\r\n\r\n  return (parts.protocol !== parsed_url.protocol) || (parts.host !== parsed_url.host)\r\n}\r\n\r\n// -----------------------------------------------------------------------------\r\n\r\nconst format_backref_value = function(backref_value, flags) {\r\n  if (!backref_value || !flags)\r\n    return backref_value\r\n\r\n  if (!flags.B && !flags.BCTLS)\r\n    return backref_value\r\n\r\n  let whitelist = ''\r\n  let blacklist = flags.BNE || ''\r\n\r\n  if (flags.B) {\r\n    if (typeof flags.B === 'string') {\r\n      // user defined\r\n      whitelist = flags.B\r\n    } else {\r\n      // all characters outside ASCII ranges: 48-57, 65-90, 97-122\r\n      whitelist = '^0-9A-Za-z'\r\n    }\r\n  }\r\n  else {\r\n    // flags.BCTLS\r\n    // all characters inside ASCII range: 0-32,127\r\n    whitelist = '\\\\x00-\\\\x20\\\\x7f'\r\n  }\r\n\r\n  return escape_backref_value(backref_value, whitelist, blacklist, flags.BNP)\r\n}\r\n\r\nconst escape_backref_value = function(backref_value, whitelist, blacklist, BNP) {\r\n  const wl_regex = new RegExp(`[${whitelist}]`, 'g')\r\n  const bl_regex = new RegExp(`[${blacklist}]`)\r\n\r\n  return backref_value.replace(wl_regex, function(c) {\r\n    if (bl_regex.test(c))\r\n      return c\r\n\r\n    if ((c === ' ') && !BNP)\r\n      return '+'\r\n\r\n    return `%${c.charCodeAt(0).toString(16).toUpperCase()}`\r\n  })\r\n}\r\n\r\n// -----------------------------------------------------------------------------\r\n\r\nmodule.exports = {\r\n  update_querystring,\r\n  parse_querystring,\r\n  parse_url,\r\n  get_parsed_url,\r\n  get_parsed_pathname,\r\n  trim_lead_slash,\r\n  get_resolved_url,\r\n  is_redirect_url,\r\n  format_backref_value\r\n}\r\n","const url_parse = require('url').parse\r\nconst uh        = require('./url-helper')\r\n\r\nconst regexs = {\r\n  \"backref-rule-variable\":     /\\$([0-9])/g,\r\n  \"backref-cond-variable\":     /%([0-9])/g,\r\n\r\n  \"server-variable\":           /%{(API_VERSION|AUTH_TYPE|CONN_REMOTE_ADDR|CONN_REMOTE_ADDR|CONTEXT_DOCUMENT_ROOT|CONTEXT_PREFIX|DOCUMENT_ROOT|HTTPS|HTTP_ACCEPT|HTTP_COOKIE|HTTP_FORWARDED|HTTP_HOST|HTTP_PROXY_CONNECTION|HTTP_REFERER|HTTP_USER_AGENT|IPV6|IS_SUBREQ|PATH_INFO|QUERY_STRING|REMOTE_ADDR|REMOTE_ADDR|REMOTE_HOST|REMOTE_IDENT|REMOTE_PORT|REMOTE_USER|REQUEST_FILENAME|REQUEST_METHOD|REQUEST_SCHEME|REQUEST_URI|SCRIPT_FILENAME|SCRIPT_GROUP|SCRIPT_USER|SERVER_ADDR|SERVER_ADMIN|SERVER_NAME|SERVER_PORT|SERVER_PROTOCOL|SERVER_SOFTWARE|THE_REQUEST|TIME|TIME_DAY|TIME_HOUR|TIME_MIN|TIME_MON|TIME_SEC|TIME_WDAY|TIME_YEAR)}/g,\r\n  \"environment-variable\":      /%{ENV:([^}]+)}/g,\r\n  \"ssl-environment-variable\":  /%{SSL:(API_VERSION|AUTH_TYPE|DOCUMENT_ROOT|HTTPS|HTTP_ACCEPT|HTTP_COOKIE|HTTP_FORWARDED|HTTP_HOST|HTTP_PROXY_CONNECTION|HTTP_REFERER|HTTP_USER_AGENT|IS_SUBREQ|PATH_INFO|QUERY_STRING|REMOTE_ADDR|REMOTE_HOST|REMOTE_IDENT|REMOTE_USER|REQUEST_FILENAME|REQUEST_METHOD|REQUEST_SCHEME|REQUEST_URI|SERVER_ADMIN|SERVER_NAME|SERVER_PORT|SERVER_PROTOCOL|SERVER_SOFTWARE|SSL_CIPHER|SSL_CIPHER_ALGKEYSIZE|SSL_CIPHER_EXPORT|SSL_CIPHER_USEKEYSIZE|SSL_CLIENT_A_KEY|SSL_CLIENT_A_SIG|SSL_CLIENT_CERT|SSL_CLIENT_CERT_CHAIN_n|SSL_CLIENT_CERT_RFC4523_CEA|SSL_CLIENT_I_DN|SSL_CLIENT_I_DN_x509|SSL_CLIENT_M_SERIAL|SSL_CLIENT_M_VERSION|SSL_CLIENT_SAN_DNS_n|SSL_CLIENT_SAN_Email_n|SSL_CLIENT_SAN_OTHER_msUPN_n|SSL_CLIENT_S_DN|SSL_CLIENT_S_DN_x509|SSL_CLIENT_VERIFY|SSL_CLIENT_V_END|SSL_CLIENT_V_REMAIN|SSL_CLIENT_V_START|SSL_COMPRESS_METHOD|SSL_PROTOCOL|SSL_SECURE_RENEG|SSL_SERVER_A_KEY|SSL_SERVER_A_SIG|SSL_SERVER_CERT|SSL_SERVER_I_DN|SSL_SERVER_I_DN_x509|SSL_SERVER_M_SERIAL|SSL_SERVER_M_VERSION|SSL_SERVER_SAN_DNS_n|SSL_SERVER_SAN_Email_n|SSL_SERVER_SAN_OTHER_dnsSRV_n|SSL_SERVER_S_DN|SSL_SERVER_S_DN_x509|SSL_SERVER_V_END|SSL_SERVER_V_START|SSL_SESSION_ID|SSL_SESSION_RESUMED|SSL_SRP_USER|SSL_SRP_USERINFO|SSL_TLS_SNI|SSL_VERSION_INTERFACE|SSL_VERSION_LIBRARY|THE_REQUEST|TIME|TIME_DAY|TIME_HOUR|TIME_MIN|TIME_MON|TIME_SEC|TIME_WDAY|TIME_YEAR)}/g,\r\n  \"http-header-variable\":      /%{HTTP:([^}]+)}/g,\r\n\r\n  \"generic-variable\":          /%{[^}]*}/g\r\n}\r\n\r\nconst get_regex = function(key) {\r\n  const regex = regexs[key]\r\n\r\n  if (regex.global)\r\n    regex.lastIndex = 0\r\n\r\n  return regex\r\n}\r\n\r\nconst get_supportedVariables = function() {\r\n  return [\r\n    get_regex('server-variable'),\r\n    get_regex('environment-variable'),\r\n    get_regex('ssl-environment-variable'),\r\n    get_regex('http-header-variable')\r\n  ]\r\n}\r\n\r\nconst isValid = function (testString, errorCallback) {\r\n  if (!testString || (typeof errorCallback !== 'function')) return\r\n\r\n  const all_variables = []\r\n  let regex, matches\r\n\r\n  regex = get_regex('generic-variable')\r\n  while (matches = regex.exec(testString)) {\r\n    all_variables.push(matches[0])\r\n  }\r\n\r\n  if (all_variables.length) {\r\n    const supportedVariables = get_supportedVariables()\r\n\r\n    for (let i=0; i < all_variables.length; i++) {\r\n      const variable = all_variables[i]\r\n      let isSupported = false\r\n\r\n      for (let j=0; j < supportedVariables.length; j++) {\r\n        regex = supportedVariables[j]\r\n\r\n        if (regex.test(variable)) {\r\n          isSupported = true\r\n          break\r\n        }\r\n      }\r\n\r\n      if (!isSupported) {\r\n        errorCallback(variable)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst resolveVariables = function(testString, errorCallback, url, variables, currentRuleMatches, previousCondMatches, flags) {\r\n  if (!testString || (typeof errorCallback !== 'function')) return\r\n\r\n  if (!variables)\r\n    variables = {}\r\n\r\n  addUrlDerivedVariables(url, variables)\r\n\r\n  const variableKeys = ['backref-rule', 'backref-cond', 'server', 'environment', 'ssl-environment', 'http-header']\r\n  let resolvedTestString = testString\r\n  let variableKey, regex, matches, variableExpression, unresolvedVariable, resolvedVariable\r\n\r\n  for (let i=0; i < variableKeys.length; i++) {\r\n    variableKey = variableKeys[i]\r\n    regex       = get_regex(variableKey + '-variable')\r\n\r\n    while (matches = regex.exec(testString)) {\r\n      variableExpression = matches[0]\r\n      unresolvedVariable = matches[1]\r\n\r\n      try {\r\n        switch(variableKey) {\r\n          case 'backref-rule': {\r\n              const backref_index = parseInt(unresolvedVariable, 10)\r\n              resolvedVariable    = currentRuleMatches[backref_index]\r\n              resolvedVariable    = uh.format_backref_value(resolvedVariable, flags)\r\n            }\r\n            break\r\n          case 'backref-cond': {\r\n              const backref_index = parseInt(unresolvedVariable, 10)\r\n              resolvedVariable    = previousCondMatches[backref_index]\r\n              resolvedVariable    = uh.format_backref_value(resolvedVariable, flags)\r\n            }\r\n            break\r\n          default:\r\n            resolvedVariable = variables[variableKey][unresolvedVariable]\r\n            break\r\n        }\r\n\r\n        if (resolvedVariable === undefined) throw ''\r\n\r\n        resolvedTestString = resolvedTestString.replaceAll(variableExpression, resolvedVariable)\r\n      }\r\n      catch(e) {\r\n        errorCallback(variableExpression, variableKey)\r\n      }\r\n    }\r\n  }\r\n\r\n  return resolvedTestString\r\n}\r\n\r\nconst addUrlDerivedVariables = function(url, variables) {\r\n  if (!url) return\r\n\r\n  if (!variables['server'])\r\n    variables['server'] = {}\r\n\r\n  if (!variables['ssl-environment'])\r\n    variables['ssl-environment'] = {}\r\n\r\n  const parts = url_parse(url)\r\n\r\n  variables['server']['REQUEST_URI']  = parts.pathname\r\n  variables['server']['QUERY_STRING'] = parts.query\r\n  variables['server']['THE_REQUEST']  = url\r\n\r\n  variables['ssl-environment']['REQUEST_URI']  = parts.pathname\r\n  variables['ssl-environment']['QUERY_STRING'] = parts.query\r\n  variables['ssl-environment']['THE_REQUEST']  = url\r\n}\r\n\r\nmodule.exports = {\r\n  isValid,\r\n  resolveVariables\r\n}\r\n","const htaccess_tester = require('./htaccess-tester/tester')\r\n\r\nmodule.exports = htaccess_tester\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","window.htaccess_tester = require('../..')\r\n"],"names":["regexs","url","RegExp","host","_searchParams","WeakMap","URL","base","_classCallCheck","_classPrivateFieldInitSpec","writable","value","resolve","this","href","_createClass","key","concat","protocol","username","password","pathname","search","hash","toString","get","set","matches","exec","Error","hostname","port","_classPrivateFieldGet","_classPrivateFieldSet","URLSearchParams","parseQueryString","arguments","length","undefined","slashes","auth","path","query","searchParams","parse","srcURL","dstURL","fields","i","field","replace","_map","_sorted","_this","substring","split","forEach","pair","index","indexOf","val","push","_toConsumableArray","splice","keys","Object","sort","values","apply","_this2","denormalized","callback","thisArg","_this3","entries","_ref","_ref2","_slicedToArray","exclude_question_mark","_ref3","_ref4","map_clone","module","exports","e","window","jsURL","RewriteRules","text","testString","condPattern","flags","map","Function","prototype","call","String","trim","filter","flag","pattern","substitution","conditions","HtaccessFile","require","RewriteRule","RewriteCond","Parser","content","Array","isArray","line","trimmed","parseContent","htaccessFile","RewriteEngineActivated","parts","part","stripQuotes","toLowerCase","RewriteBase","rule","s","test","slice","vi","fv","supportedFlags","baseCondition","assign","condPatternFlags","re","isNC","runTest","variables","currentRuleMatches","previousCondMatches","log","errors","isValid","is_valid","is_match","resolvedTestString","resolveVariables","variable","result","testVal","condVal","parseInt","isValidTestString","isValidFlags","hasFlag","isOR","fh","uh","baseRule","runAllTests","get_parsed_pathname","logs","doAllConditionsMatch","allConditionsMatch","new_url","resolvedSubstitutionString","variableKey","get_backref_format_flags","update_querystring","isQSL","isQSD","isQSA","all_conditions_match","getStatusCode","getRedirectStatusCode","getMimeType","getSkipCount","is_redirect","status_code","is_redirect_url","is_passthrough","isPassThrough","is_last","isLast","nextCount","getNextCount","runNext","trim_lead_slash","get_resolved_url","OK","count","iterations","get_resolved_filepath","isValidSubstitutionString","state","currentIsOr","prevWasOr","orConditionMet","getFlagIntegerValue","getFlagStringValue","getB","getBNE","isBCTLS","isBNP","htaccessParser","HtaccessTester","test_data","test_results","setRewriteBase","rules","_this$processAllRules","processAllRules","success","error","message","htaccessContent","htaccess","parse_url","allLogs","finalResult","skip_count","someLogs","is_skipped","file_path","data","rb","relative_path","errorCallback","isSupported","j","supportedFlag","defaultValue","url_parse","url_resolve","parse_querystring","QSL","lastIndexOf","parsed_url","escape_backref_value","backref_value","whitelist","blacklist","BNP","wl_regex","bl_regex","c","charCodeAt","toUpperCase","old_url","QSD","QSA","old_query","new_query","get_parsed_url","should_trim_lead_slash","should_unescape","decodeURI","to","format_backref_value","B","BCTLS","BNE","get_regex","regex","global","lastIndex","addUrlDerivedVariables","all_variables","supportedVariables","variableExpression","unresolvedVariable","resolvedVariable","variableKeys","replaceAll","htaccess_tester","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","id","loaded","__webpack_modules__","nmd","paths","children"],"sourceRoot":""}